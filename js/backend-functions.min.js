$j(document).ready(function(){$j(".qtranxs-translatable").on("keyup",function(){bookacti_update_qtx_field(this)});$j(".bookacti-tabs").tabs();$j(".bookacti-show-hide-advanced-options").on("click",function(){bookacti_show_hide_advanced_options($j(this))});$j("body").on("change",".bookacti-multiple-select-container .bookacti-multiple-select",function(){bookacti_switch_select_to_multiple(this)});bookacti_init_tooltip();$j("#bookacti-dismiss-5stars-rating").on("click",function(){bookacti_dismiss_5stars_rating_notice()});
bookacti_select2_init();$j(".bookacti-backend-dialog").dialog({autoOpen:!1,open:function(){$j.ui&&$j.ui.dialog&&!$j.ui.dialog.prototype._allowInteractionRemapped&&$j(this).closest(".ui-dialog").length&&($j.ui.dialog.prototype._allowInteraction?($j.ui.dialog.prototype._allowInteraction=function(a){return $j(a.target).closest(".select2-drop").length||"undefined"===typeof ui_dialog_interaction?!0:ui_dialog_interaction.apply(this,arguments)},$j.ui.dialog.prototype._allowInteractionRemapped=!0):$j.error("You must upgrade jQuery UI or else."))},
_allowInteraction:function(a){return!(!$j(a.target).is(".select2-input")||this._super(a))}});$j("body").on("keyup mouseup change",".bookacti-duration-field",function(){var a=$j(this).closest(".bookacti-duration-field-container").siblings(".bookacti-duration-value"),b=a.siblings(".bookacti-duration-field-container").find('.bookacti-duration-field[data-unit="day"]').val(),c=a.siblings(".bookacti-duration-field-container").find('.bookacti-duration-field[data-unit="hour"]').val(),e=a.siblings(".bookacti-duration-field-container").find('.bookacti-duration-field[data-unit="minute"]').val(),
d="";if($j.isNumeric(b)||$j.isNumeric(c)||$j.isNumeric(e))d=0,$j.isNumeric(e)&&(d+=60*parseInt(e)),$j.isNumeric(c)&&(d+=3600*parseInt(c)),$j.isNumeric(b)&&(d+=86400*parseInt(b));a.val(d).trigger("change");$j(this).closest(".bookacti-duration-field-container").siblings(".bookacti-duration-hint").remove();$j.isNumeric(d)||(d=0);a=moment.utc().add(d+bookacti_localized.utc_offset,"s").formatPHP(bookacti_localized.date_format_long);$j(this).closest(".bookacti-duration-field-container").parent().append('<div class="bookacti-duration-hint">'+
a+"</div>")});$j(".bookacti-date-intervals-container").on("click",".bookacti-add-date-interval",function(){bookacti_add_days_off_row($j(this).closest(".bookacti-date-intervals-container").find(".bookacti-date-intervals-table-container"))});$j(".bookacti-date-intervals-container").on("click",".bookacti-delete-date-interval",function(){bookacti_delete_days_off_row($j(this).closest(".bookacti-date-intervals-container").find(".bookacti-date-intervals-table-container"),$j(this).closest("tr"))});$j("body").on("bookacti_empty_all_dialogs_forms",
function(a,b){bookacti_delete_days_off_rows($j(b+" .bookacti-date-intervals-table-container"));$j(b+" input.bookacti-date-interval-from, "+b+" input.bookacti-date-interval-to").attr("min","").attr("max","")})});
function bookacti_show_hide_advanced_options(a){var b=a.attr("for"),c=a.closest("form").find(".bookacti-hidden-field");b&&$j("#"+b).length&&(c=$j("#"+b));a.toggleClass("bookacti-show-advanced-options bookacti-hide-advanced-options");a.hasClass("bookacti-show-advanced-options")?(a.html(a.data("show-title")),c.hide(200,function(){a.closest("fieldset").length&&a.closest("fieldset").addClass("bookacti-fieldset-no-css")})):a.hasClass("bookacti-hide-advanced-options")&&(a.html(a.data("hide-title")),a.closest("fieldset").length&&
a.closest("fieldset").removeClass("bookacti-fieldset-no-css"),c.show(200))}
function bookacti_init_add_and_remove_items(){$j(".bookacti-items-container").on("click",".bookacti-add-items",function(a){var b=$j(this).closest(".bookacti-items-container");a=b.find(".bookacti-add-new-items-select-box");var c=a.is("[multiple]"),e=a.val(),d=e;c||(d=[e]);$j.each(d,function(f,g){b.find('.bookacti-add-new-items-select-box option[value="'+g+'"]').clone().appendTo(b.find(".bookacti-items-select-box"));b.find('.bookacti-add-new-items-select-box option[value="'+g+'"]').hide().attr("disabled",
!0);b.find(".bookacti-add-new-items-select-box").val(b.find(".bookacti-add-new-items-select-box option:enabled:first").val())});a.hasClass("bookacti-select2-no-ajax")&&a.select2("destroy").select2()});$j(".bookacti-items-container").on("click",".bookacti-remove-items",function(a){var b=$j(this).closest(".bookacti-items-container");a=b.data("type");var c="";"users"===a?c=bookacti_localized.current_user_id:"templates"===a&&(c=bookacti.selected_template);a=b.find(".bookacti-add-new-items-select-box");
var e=b.find(".bookacti-items-select-box").is("[multiple]"),d=b.find(".bookacti-items-select-box").val(),f=d;e||(f=[d]);$j.each(f,function(g,h){h!=c&&(b.find('.bookacti-items-select-box option[value="'+h+'"]').remove(),b.find('.bookacti-add-new-items-select-box option[value="'+h+'"]').show().attr("disabled",!1),b.find(".bookacti-add-new-items-select-box").val(h))});a.hasClass("bookacti-select2-no-ajax")&&a.select2("destroy").select2()})}
function bookacti_empty_all_dialog_forms(a){a="undefined"!==typeof a&&a?a+" ":".bookacti-backend-dialog ";$j(a+".bookacti-form-error").remove();$j(a+'input[type="hidden"]:not([name="action"]):not([name^="nonce"]):not([name="_wp_http_referer"]):not([name="qtranslate-edit-language"]):not(.bookacti-onoffswitch-hidden-input)').val("");$j(a+'input[type="text"]:not([readonly])').val("");$j(a+'input[type="email"]').val("");$j(a+'input[type="password"]').val("");$j(a+'input[type="tel"]').val("");$j(a+'input[type="number"]').val("");
$j(a+'input[type="date"]').val("");$j(a+'input[type="time"]').val("");$j(a+"textarea").val("");$j(a+'input[type="color"]').val("#3a87ad");$j(a+'input[type="checkbox"]').prop("checked",!1);$j(a+'input[type="radio"]').prop("checked",!1);$j(a+"option").prop("selected",!1);$j(a+"select.bookacti-add-new-items-select-box option").show().attr("disabled",!1);$j(a+"select.bookacti-items-select-box option").remove();$j(a+".bookacti-duration-hint").remove();$j(a+'input[type="file"]').length&&$j(a+'input[type="file"]').each(function(){$j(this).wrap("<form>").closest("form").get(0).reset();
$j(this).unwrap()});"undefined"!==typeof tinyMCE&&tinyMCE&&$j(a+"textarea.wp-editor-area").each(function(){var b=$j(this).attr("id");tinyMCE.get(b)&&tinyMCE.get(b).setContent("")});$j(a+".bookacti-multiple-select").length&&$j(a+".bookacti-multiple-select").each(function(){bookacti_switch_select_to_multiple(this)});$j("body").trigger("bookacti_empty_all_dialogs_forms",[a])}
function bookacti_fill_fields_from_array(a,b,c){b=b||"";c="undefined"!==typeof c&&c?c+" ":"";$j.each(a,function(e,d){var f=b?b+"["+e+"]":e;if($j.isPlainObject(d))return bookacti_fill_fields_from_array(d,f,c),!0;$j(c+'select[name="'+f+'[]"]').length&&(!$j.isArray(d)||$j.isArray(d)&&1>=d.length)&&(e=$j(c+'select[name="'+f+'[]"]').attr("id"),$j(c+'input.bookacti-multiple-select[data-select-id="'+e+'"]').length&&($j(c+'input.bookacti-multiple-select[data-select-id="'+e+'"]').prop("checked",!1),bookacti_switch_select_to_multiple(c+
'input.bookacti-multiple-select[data-select-id="'+e+'"]'),$j(c+'select[name="'+f+'"] option').prop("selected",!1)));$j(c+'select[name="'+f+'"]:not(.bookacti-items-select-box)').length&&$j.isArray(d)&&1<d.length&&(e=$j(c+'select[name="'+f+'"]').attr("id"),$j(c+'input.bookacti-multiple-select[data-select-id="'+e+'"]').length&&($j(c+'input.bookacti-multiple-select[data-select-id="'+e+'"]').prop("checked",!0),bookacti_switch_select_to_multiple(c+'input.bookacti-multiple-select[data-select-id="'+e+'"]'),
$j(c+'select[name="'+f+'[]"] option').prop("selected",!1)));if($j(c+'input[type="checkbox"][name="'+f+'[]"]').length||$j(c+'input[type="checkbox"][name="'+f+'"]').length)$j.isArray(d)?($j(c+'input[type="checkbox"][name="'+f+'[]"]').prop("checked",!1),$j.each(d,function(m,k){$j(c+'input[type="checkbox"][name="'+f+'[]"][value="'+k+'"]').prop("checked",!0).trigger("change")})):1==d?$j(c+'input[type="checkbox"][name="'+f+'"]').prop("checked",!0).trigger("change"):$j(c+'input[type="checkbox"][name="'+
f+'"]').prop("checked",!1).trigger("change");else if($j(c+'input[name="'+f+'"]').is(":radio"))$j(c+'input[name="'+f+'"][value="'+d+'"]').prop("checked",!0).trigger("change");else if($j(c+'select[name="'+f+'[]"].bookacti-items-select-box').length){$j.isArray(d)||(d=[d]);var g=$j(c+'select[name="'+f+'[]"].bookacti-items-select-box'),h=g.closest(".bookacti-items-container").find(".bookacti-add-new-items-select-box");h.find("option").show().attr("disabled",!1);g.find("option").remove();$j.each(d,function(m,
k){h.find('option[value="'+k+'"]').clone().appendTo(g);h.find('option[value="'+k+'"]').hide().attr("disabled",!0);h.val()!=k&&h.val()||h.val(h.find("option:enabled:first").val())});g.find("option").length&&(g.find("option").prop("selected",!0),g.trigger("change"))}else if($j(c+'select[name="'+f+'"]').length)$j(c+'select[name="'+f+'"] option[value="'+d+'"]').prop("selected",!0),$j(c+'select[name="'+f+'"]').trigger("change");else if($j(c+'select[name="'+f+'[]"]').length)$j.isArray(d)||(d=[d]),$j.each(d,
function(m,k){$j(c+'select[name="'+f+'[]"] option[value="'+k+'"]').prop("selected",!0)}),$j(c+'select[name="'+f+'[]"]').trigger("change");else{if("file"===$j(c+'input[name="'+f+'"]').attr("type"))return!0;"color"!==$j(c+'input[name="'+f+'"]').attr("type")||d||(d="#3a87ad");"time"===$j(c+'input[name="'+f+'"]').attr("type")&&24<=parseInt(d.substr(0,2))&&(d=bookacti_pad(parseInt(d.substr(0,2))%24,2)+d.substr(2));$j(c+'input[name="'+f+'"]').val(d).trigger("change");$j(c+'textarea[name="'+f+'"]').val(d).trigger("change");
"undefined"!==typeof tinyMCE&&tinyMCE&&$j(c+'textarea[name="'+f+'"]').hasClass("wp-editor-area")&&(e=$j(c+'textarea[name="'+f+'"]').attr("id"),tinyMCE.get(e)&&tinyMCE.get(e).setContent(d));if($j(c+'input[name="'+f+'"].bookacti-duration-value').length){e="";if($j.isNumeric(d)&&(d=parseInt(d),0<=d)){var l=Math.floor(d/86400);d%=86400;var n=Math.floor(d/3600);e=Math.floor(d%3600/60)}$j(c+'input[name="'+f+'"].bookacti-duration-value').siblings(".bookacti-duration-field-container").find('.bookacti-duration-field[data-unit="day"]').val(l).trigger("change");
$j(c+'input[name="'+f+'"].bookacti-duration-value').siblings(".bookacti-duration-field-container").find('.bookacti-duration-field[data-unit="hour"]').val(n).trigger("change");$j(c+'input[name="'+f+'"].bookacti-duration-value').siblings(".bookacti-duration-field-container").find('.bookacti-duration-field[data-unit="minute"]').val(e).trigger("change")}}})}
function bookacti_switch_select_to_multiple(a){if($j(a).length){var b=$j(a).data("select-id"),c=$j("select#"+b).attr("name"),e=$j(a).is(":checked"),d=$j("select#"+b).val();$j("select#"+b).prop("multiple",e);$j("select#"+b+' option[value="all"]').prop("disabled",e);$j("select#"+b+' option[value="none"]').prop("disabled",e);$j("select#"+b+' option[value="parent"]').prop("disabled",e);$j("select#"+b+' option[value="site"]').prop("disabled",e);$j("select#"+b+" option:disabled:selected").prop("selected",
!1);e&&0>c.indexOf("[]")?($j("select#"+b).attr("name",c+"[]"),$j(a).closest(".bookacti-multiple-select-container").find("label span.dashicons").removeClass("dashicons-plus").addClass("dashicons-minus")):($j("select#"+b).attr("name",c.replace("[]","")),$j(a).closest(".bookacti-multiple-select-container").find("label span.dashicons").removeClass("dashicons-minus").addClass("dashicons-plus"));if(!e){var f=$j("select#"+b+" option:not(:disabled):first").length?$j("select#"+b+" option:not(:disabled):first").val():
"";d&&($j.isArray(d)||(d=[d]),$j.each(d,function(g,h){g=$j("select#"+b+' option[value="'+h+'"]');if(g.length&&!g.is(":disabled"))return f=g.attr("value"),!1}));$j("select#"+b).val(f).trigger("change")}$j("select#"+b).hasClass("select2-hidden-accessible")&&$j.fn.select2&&($j("select#"+b).select2("destroy"),bookacti_select2_init())}}
function bookacti_fill_items_selectbox(a,b,c){c=c||"users";if(a.length&&b.length){var e=a.find(".bookacti-add-new-items-select-box"),d=a.find(".bookacti-items-select-box");if(e.length&&d.length){var f=[];$j.each(b,function(g,h){e.find('option[value="'+h+'"]').length?(e.find('option[value="'+h+'"]').clone().appendTo(d),e.find('option[value="'+h+'"]').hide().attr("disabled",!0)):(d.append('<option value="'+h+'" class="bookacti-unknown-item">'+h+"</option>"),f.push(h));e.val()!=h&&e.val()||e.val(e.find("option:enabled:first").val())});
f.length&&$j.ajax({url:ajaxurl,type:"POST",data:{action:"bookactiSelect2Query_"+c,id__in:f,name:$j(this).attr("name")?$j(this).attr("name"):"",id:$j(this).attr("id")?$j(this).attr("id"):"",allow_current:$j(this).find('option[value="current"]').length?1:0,nonce:bookacti_localized.nonce_query_select2_options},dataType:"json",success:function(g){"success"===g.status?$j.each(g.options,function(h,l){d.find('.bookacti-unknown-item[value="'+l.id+'"]').html(l.text).removeClass("bookacti-unknown-item")}):
"failed"===g.status&&(console.log("undefined"!==typeof g.message?g.message:bookacti_localized.error),console.log(g))},error:function(g){console.log("AJAX "+bookacti_localized.error);console.log(g)},complete:function(){}})}}}
function bookacti_show_hide_template_related_options(a,b){var c=[];$j.isNumeric(a)&&(a=[a]);$j.isArray(a)||(a=[]);b.prop("disabled",!1);b.removeClass("bookacti-hide-fields");$j.isEmptyObject(a)||(b.each(function(){var e=$j(this),d=e.data("bookacti-show-if-templates").toString();d=0<=d.indexOf(",")?d.split(","):[d];var f=!0;$j.each(a,function(g,h){0<=$j.inArray(h.toString(),d)&&(f=!1)});f&&(e.is(":selected")&&c.push(e),e.addClass("bookacti-hide-fields"),e.prop("disabled",!0))}),$j.each(c,function(e,
d){d.removeAttr("selected");d.siblings("option:not(.bookacti-hide-fields):not(:disabled):first").prop("selected",!0)}))}function bookacti_update_qtx_field(a){if("undefined"!==typeof qTranslateConfig){var b=qTranslateConfig.js.get_qtx().getActiveLanguage(),c=$j(a).attr("name");void 0!==b&&$j('input[name="qtranslate-fields['+c+"]["+b+']"]').val($j(a).val())}}
function bookacti_refresh_qtx_field(a){if("undefined"!==typeof qTranslateConfig){var b=qTranslateConfig.js.get_qtx();$j(a).removeClass("qtranxs-translatable");b=b.refreshContentHook(a);$j(a).addClass("qtranxs-translatable");"undefined"!==typeof tinyMCE&&tinyMCE&&$j("#"+a.id).hasClass("wp-editor-area")&&tinyMCE.get(a.id)&&(b.mce=tinyMCE.get(a.id),b.mce.setContent(b.contentField.value,{format:"html"}))}}
function bookacti_dismiss_5stars_rating_notice(){$j(".bookacti-5stars-rating-notice").remove();$j.ajax({url:ajaxurl,type:"POST",data:{action:"bookactiDismiss5StarsRatingNotice",nonce:bookacti_localized.nonce_dismiss_5stars_rating_notice},dataType:"json",success:function(a){"failed"===a.status&&(console.log("undefined"!==typeof a.message?a.message:bookacti_localized.error),console.log(a))},error:function(a){console.log("AJAX "+bookacti_localized.error);console.log(a)},complete:function(){}})}
function bookacti_fill_days_off(a,b){if("undefined"!==typeof b&&($j.isArray(b)||$j.isPlainObject(b))&&!(0>=b.length)){bookacti_delete_days_off_rows(a);var c=a.find("tbody"),e=0;$j.each(b,function(d,f){0<e&&bookacti_add_days_off_row(a);c.find("tr:last .bookacti-date-interval-from").val(f.from);c.find("tr:last .bookacti-date-interval-to").val(f.to);++e})}}
function bookacti_add_days_off_row(a){var b=a.find("tbody");a=a.data("name")+"["+b.find("tr").length+"]";b.find("tr:first").clone().appendTo(b);b.find("tr:last .bookacti-date-interval-from").attr("name",a+"[from]").val("");b.find("tr:last .bookacti-date-interval-to").attr("name",a+"[to]").val("")}
function bookacti_delete_days_off_row(a,b){b=b||null;var c=a.find("tbody");if(1>=c.find("tr").length)c.find("tr:first .bookacti-date-interval-from, tr:first .bookacti-date-interval-to").val("");else if(null!=b){b.remove();var e=0,d=a.data("name");c.find("tr").each(function(){var f=d+"["+e+"]";$j(this).find(".bookacti-date-interval-from").attr("name",f+"[from]");$j(this).find(".bookacti-date-interval-to").attr("name",f+"[to]");++e})}}
function bookacti_delete_days_off_rows(a){var b=a.find("tbody");b.find("tr:not(:first)").remove();bookacti_delete_days_off_row(a,b.find("tr:first"))};
