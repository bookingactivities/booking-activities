$j(document).ready(function(){$j(".qtranxs-translatable").on("keyup",function(){bookacti_update_qtx_field(this)});$j(".bookacti-tabs").tabs();$j(".bookacti-show-hide-advanced-options").on("click",function(){bookacti_show_hide_advanced_options($j(this))});$j("body").on("change",".bookacti-multiple-select-container .bookacti-multiple-select",function(){bookacti_switch_select_to_multiple(this)});bookacti_init_tooltip();$j("#bookacti-dismiss-5stars-rating").on("click",function(){bookacti_dismiss_5stars_rating_notice()});
bookacti_select2_init();$j(".bookacti-backend-dialog").dialog({open:function(){$j.ui&&$j.ui.dialog&&!$j.ui.dialog.prototype._allowInteractionRemapped&&$j(this).closest(".ui-dialog").length&&($j.ui.dialog.prototype._allowInteraction?($j.ui.dialog.prototype._allowInteraction=function(a){return $j(a.target).closest(".select2-drop").length||"undefined"===typeof ui_dialog_interaction?!0:ui_dialog_interaction.apply(this,arguments)},$j.ui.dialog.prototype._allowInteractionRemapped=!0):$j.error("You must upgrade jQuery UI or else."))},
_allowInteraction:function(a){return!(!$j(a.target).is(".select2-input")||this._super(a))}});$j("body").on("keyup mouseup change",".bookacti-duration-field",function(){var a=$j(this).closest(".bookacti-duration-field-container").siblings(".bookacti-duration-value"),b=a.siblings(".bookacti-duration-field-container").find('.bookacti-duration-field[data-duration-unit="day"]').val(),d=a.siblings(".bookacti-duration-field-container").find('.bookacti-duration-field[data-duration-unit="hour"]').val(),f=
a.siblings(".bookacti-duration-field-container").find('.bookacti-duration-field[data-duration-unit="minute"]').val(),c="";if($j.isNumeric(b)||$j.isNumeric(d)||$j.isNumeric(f))c=0,$j.isNumeric(f)&&(c+=60*parseInt(f)),$j.isNumeric(d)&&(c+=3600*parseInt(d)),$j.isNumeric(b)&&(c+=86400*parseInt(b));a.val(c).trigger("change");$j(this).closest(".bookacti-duration-field-container").siblings(".bookacti-duration-hint").remove();$j.isNumeric(c)||(c=0);a=moment.utc().add(c+bookacti_localized.utc_offset,"s").formatPHP(bookacti_localized.date_format_long);
$j(this).closest(".bookacti-duration-field-container").parent().find(".bookacti-duration-field-container").last().after('<div class="bookacti-duration-hint">'+a+"</div>")});$j(".bookacti-date-intervals-container").on("click",".bookacti-add-date-interval",function(){bookacti_add_days_off_row($j(this).closest(".bookacti-date-intervals-container").find(".bookacti-date-intervals-table-container"))});$j(".bookacti-date-intervals-container").on("click",".bookacti-delete-date-interval",function(){bookacti_delete_days_off_row($j(this).closest(".bookacti-date-intervals-container").find(".bookacti-date-intervals-table-container"),
$j(this).closest("tr"))});$j("body").on("bookacti_empty_all_dialogs_forms",function(a,b){bookacti_delete_days_off_rows($j(b+" .bookacti-date-intervals-table-container"));$j(b+" input.bookacti-date-interval-from, "+b+" input.bookacti-date-interval-to").attr("min","").attr("max","")})});
function bookacti_show_hide_advanced_options(a){var b=a.attr("for"),d=a.closest("form").find(".bookacti-hidden-field");b&&$j("#"+b).length&&(d=$j("#"+b));a.toggleClass("bookacti-show-advanced-options bookacti-hide-advanced-options");a.hasClass("bookacti-show-advanced-options")?(a.html(a.data("show-title")),d.hide(200,function(){a.closest("fieldset").length&&a.closest("fieldset").addClass("bookacti-fieldset-no-css")})):a.hasClass("bookacti-hide-advanced-options")&&(a.html(a.data("hide-title")),a.closest("fieldset").length&&
a.closest("fieldset").removeClass("bookacti-fieldset-no-css"),d.show(200))}
function bookacti_empty_all_dialog_forms(a){a="undefined"!==typeof a&&a?a+" ":".bookacti-backend-dialog ";$j(a+".bookacti-form-error").remove();$j(a+".bookacti-notices").not(a+".bookacti-booking-system-container .bookacti-notices").remove();$j(a+".bookacti-booking-system-container .bookacti-notices").empty().hide();$j(a+".bookacti-input-warning").removeClass("bookacti-input-warning");$j(a+".bookacti-input-error").removeClass("bookacti-input-error");$j(a+'input[type="hidden"]:not([name="action"]):not([name^="nonce"]):not([name="_wp_http_referer"]):not([name="qtranslate-edit-language"]):not(.bookacti-onoffswitch-hidden-input)').val("");
$j(a+'input[type="text"]:not([readonly])').val("");$j(a+'input[type="email"]').val("");$j(a+'input[type="password"]').val("");$j(a+'input[type="tel"]').val("");$j(a+'input[type="number"]').val("");$j(a+'input[type="date"]').val("");$j(a+'input[type="time"]').val("");$j(a+"textarea").val("");$j(a+'input[type="color"]').val("");$j(a+'input[type="checkbox"]').prop("checked",!1);$j(a+'input[type="radio"]').prop("checked",!1);$j(a+"select").val(null).trigger("change");$j(a+".bookacti-duration-hint").remove();
$j(a+'input[type="file"]').length&&$j(a+'input[type="file"]').each(function(){$j(this).wrap("<form>").closest("form").get(0).reset();$j(this).unwrap()});"undefined"!==typeof tinyMCE&&tinyMCE&&$j(a+"textarea.wp-editor-area").each(function(){var b=$j(this).attr("id");tinyMCE.get(b)&&tinyMCE.get(b).setContent("")});$j(a+".bookacti-multiple-select").length&&$j(a+".bookacti-multiple-select").each(function(){bookacti_switch_select_to_multiple(this)});$j("body").trigger("bookacti_empty_all_dialogs_forms",
[a])}
function bookacti_fill_fields_from_array(a,b,d){b=b||"";d="undefined"!==typeof d&&d?d+" ":"";$j.each(a,function(f,c){var e=b?b+"["+f+"]":f;if($j.isPlainObject(c))return bookacti_fill_fields_from_array(c,e,d),!0;$j(d+'select[name="'+e+'[]"]').length&&(!$j.isArray(c)||$j.isArray(c)&&1>=c.length)&&(f=$j(d+'select[name="'+e+'[]"]').attr("id"),$j(d+'input.bookacti-multiple-select[data-select-id="'+f+'"]').length&&($j(d+'input.bookacti-multiple-select[data-select-id="'+f+'"]').prop("checked",!1),bookacti_switch_select_to_multiple(d+'input.bookacti-multiple-select[data-select-id="'+
f+'"]'),$j(d+'select[name="'+e+'"] option').prop("selected",!1)));$j(d+'select[name="'+e+'"]').length&&$j.isArray(c)&&1<c.length&&(f=$j(d+'select[name="'+e+'"]').attr("id"),$j(d+'input.bookacti-multiple-select[data-select-id="'+f+'"]').length&&($j(d+'input.bookacti-multiple-select[data-select-id="'+f+'"]').prop("checked",!0),bookacti_switch_select_to_multiple(d+'input.bookacti-multiple-select[data-select-id="'+f+'"]'),$j(d+'select[name="'+e+'[]"] option').prop("selected",!1)));if($j(d+'input[type="checkbox"][name="'+
e+'[]"]').length||$j(d+'input[type="checkbox"][name="'+e+'"]').length)$j.isArray(c)?($j(d+'input[type="checkbox"][name="'+e+'[]"]').prop("checked",!1),$j.each(c,function(k,l){$j(d+'input[type="checkbox"][name="'+e+'[]"][value="'+l+'"]').prop("checked",!0).trigger("change")})):1==c?$j(d+'input[type="checkbox"][name="'+e+'"]').prop("checked",!0).trigger("change"):$j(d+'input[type="checkbox"][name="'+e+'"]').prop("checked",!1).trigger("change");else if($j(d+'input[name="'+e+'"]').is(":radio"))$j(d+'input[name="'+
e+'"][value="'+c+'"]').prop("checked",!0).trigger("change");else if($j(d+'select[name="'+e+'"]').length)$j(d+'select[name="'+e+'"] option[value="'+c+'"]').prop("selected",!0),$j(d+'select[name="'+e+'"]').trigger("change");else if($j(d+'select[name="'+e+'[]"]').length)$j.isArray(c)||(c=[c]),$j.each(c,function(k,l){k=$j(d+'select[name="'+e+'[]"] option[value="'+l+'"]');$j(d+'select[name="'+e+'[]"] option[value="'+l+'"]').prop("selected",!0);$j(d+'select[name="'+e+'[]"]').data("sortable")&&(k.detach(),
$j(d+'select[name="'+e+'[]"]').append(k))}),$j(d+'select[name="'+e+'[]"]').trigger("change");else{if("file"===$j(d+'input[name="'+e+'"]').attr("type"))return!0;"color"!==$j(d+'input[name="'+e+'"]').attr("type")||c||(c="#3a87ad");"time"===$j(d+'input[name="'+e+'"]').attr("type")&&24<=parseInt(c.substr(0,2))&&(c=bookacti_pad(parseInt(c.substr(0,2))%24,2)+c.substr(2));$j(d+'input[name="'+e+'"]').val(c).trigger("change");$j(d+'textarea[name="'+e+'"]').val(c).trigger("change");"undefined"!==typeof tinyMCE&&
tinyMCE&&$j(d+'textarea[name="'+e+'"]').hasClass("wp-editor-area")&&(f=$j(d+'textarea[name="'+e+'"]').attr("id"),tinyMCE.get(f)&&tinyMCE.get(f).setContent(c));if($j(d+'input[name="'+e+'"].bookacti-duration-value').length){f="";if($j.isNumeric(c)&&(c=parseInt(c),0<=c)){var g=Math.floor(c/86400);c%=86400;var h=Math.floor(c/3600);f=Math.floor(c%3600/60)}$j(d+'input[name="'+e+'"].bookacti-duration-value').siblings(".bookacti-duration-field-container").find('.bookacti-duration-field[data-duration-unit="day"]').val(g).trigger("change");
$j(d+'input[name="'+e+'"].bookacti-duration-value').siblings(".bookacti-duration-field-container").find('.bookacti-duration-field[data-duration-unit="hour"]').val(h).trigger("change");$j(d+'input[name="'+e+'"].bookacti-duration-value').siblings(".bookacti-duration-field-container").find('.bookacti-duration-field[data-duration-unit="minute"]').val(f).trigger("change")}}})}
function bookacti_switch_select_to_multiple(a){if($j(a).length){var b=$j(a).data("select-id"),d=$j("select#"+b).attr("name"),f=$j(a).is(":checked"),c=$j("select#"+b).val();$j("select#"+b).prop("multiple",f);$j("select#"+b+' option[value="all"]').prop("disabled",f);$j("select#"+b+' option[value="none"]').prop("disabled",f);$j("select#"+b+' option[value="parent"]').prop("disabled",f);$j("select#"+b+' option[value="site"]').prop("disabled",f);$j("select#"+b+' option[data-not-multiple="1"]').prop("disabled",
f);$j("select#"+b+" option:disabled:selected").prop("selected",!1);f&&0>d.indexOf("[]")?($j("select#"+b).attr("name",d+"[]"),$j(a).closest(".bookacti-multiple-select-container").find("label span.dashicons").removeClass("dashicons-plus").addClass("dashicons-minus")):($j("select#"+b).attr("name",d.replace("[]","")),$j(a).closest(".bookacti-multiple-select-container").find("label span.dashicons").removeClass("dashicons-minus").addClass("dashicons-plus"));if(!f){var e=null;c&&($j.isArray(c)||(c=[c]),
$j.each(c,function(g,h){g=$j("select#"+b+' option[value="'+h+'"]');if(g.length&&!g.is(":disabled"))return e=g.attr("value"),!1}));$j("select#"+b).val(e).trigger("change")}if($j("select#"+b).hasClass("select2-hidden-accessible")){if(!$j.fn.select2)return;$j("select#"+b).select2("destroy");bookacti_select2_init()}$j("select#"+b).trigger("bookacti_switched_multiple")}}
function bookacti_fill_items_selectbox(a,b,d){d=d||"users";if(a.length){"object"===typeof b&&(b=Object.values(b));var f=[];b.length&&$j.each(b,function(c,e){c=a.find('option[value="'+e+'"]');c.length?a.data("sortable")&&(c.detach(),a.append(c)):(a.append('<option value="'+e+'" class="bookacti-unknown-item">'+e+"</option>"),$j.isNumeric(e)&&f.push(parseInt(e)))});a.val(b.length?b:null).trigger("change");f.length&&(bookacti_add_loading_html(a.parent()),$j.ajax({url:ajaxurl,type:"POST",data:{action:"bookactiSelect2Query_"+
d,id__in:f,name:a.attr("name")?a.attr("name"):"",id:a.attr("id")?a.attr("id"):"",nonce:bookacti_localized.nonce_query_select2_options},dataType:"json",success:function(c){"success"===c.status?c.options.length&&($j.each(c.options,function(e,g){a.find('.bookacti-unknown-item[value="'+g.id+'"]').html(g.text).removeClass("bookacti-unknown-item")}),a.hasClass("select2-hidden-accessible")&&(a.select2("destroy"),bookacti_select2_init())):"failed"===c.status&&(console.log("undefined"!==typeof c.message?c.message:
bookacti_localized.error),console.log(c))},error:function(c){console.log("AJAX "+bookacti_localized.error);console.log(c)},complete:function(){bookacti_remove_loading_html(a.parent())}}))}}
function bookacti_show_hide_template_related_options(a,b){var d=[];$j.isNumeric(a)&&(a=[a]);$j.isArray(a)||(a=[]);b.prop("disabled",!1);b.removeClass("bookacti-hide-fields");$j.isEmptyObject(a)||(b.each(function(){var f=$j(this),c=f.data("bookacti-show-if-templates").toString();c=0<=c.indexOf(",")?c.split(","):[c];var e=!0;$j.each(a,function(g,h){0<=$j.inArray(h.toString(),c)&&(e=!1)});e&&(f.is(":selected")&&d.push(f),f.addClass("bookacti-hide-fields"),f.prop("disabled",!0))}),$j.each(d,function(f,
c){c.removeAttr("selected");c.siblings("option:not(.bookacti-hide-fields):not(:disabled):first").prop("selected",!0)}),b.parent("select").hasClass("select2-hidden-accessible")&&(b.parent("select").select2("destroy"),bookacti_select2_init()))}function bookacti_update_qtx_field(a){if("undefined"!==typeof qTranslateConfig){var b=qTranslateConfig.js.get_qtx().getActiveLanguage(),d=$j(a).attr("name");void 0!==b&&$j('input[name="qtranslate-fields['+d+"]["+b+']"]').val($j(a).val())}}
function bookacti_refresh_qtx_field(a){if("undefined"!==typeof qTranslateConfig){var b=qTranslateConfig.js.get_qtx();$j(a).removeClass("qtranxs-translatable");b=b.refreshContentHook(a);$j(a).addClass("qtranxs-translatable");"undefined"!==typeof tinyMCE&&tinyMCE&&$j("#"+a.id).hasClass("wp-editor-area")&&tinyMCE.get(a.id)&&(b.mce=tinyMCE.get(a.id),b.mce.setContent(b.contentField.value,{format:"html"}))}}
function bookacti_dismiss_5stars_rating_notice(){$j(".bookacti-5stars-rating-notice").remove();$j.ajax({url:ajaxurl,type:"POST",data:{action:"bookactiDismiss5StarsRatingNotice",nonce:bookacti_localized.nonce_dismiss_5stars_rating_notice},dataType:"json",success:function(a){"failed"===a.status&&(console.log("undefined"!==typeof a.message?a.message:bookacti_localized.error),console.log(a))},error:function(a){console.log("AJAX "+bookacti_localized.error);console.log(a)},complete:function(){}})}
function bookacti_fill_days_off(a,b){if("undefined"!==typeof b&&($j.isArray(b)||$j.isPlainObject(b))&&!(0>=b.length)){bookacti_delete_days_off_rows(a);var d=a.find("tbody"),f=0;$j.each(b,function(c,e){0<f&&bookacti_add_days_off_row(a);d.find("tr:last .bookacti-date-interval-from").val(e.from);d.find("tr:last .bookacti-date-interval-to").val(e.to);++f})}}
function bookacti_add_days_off_row(a){var b=a.find("tbody");a=a.data("name")+"["+b.find("tr").length+"]";b.find("tr:first").clone().appendTo(b);b.find("tr:last .bookacti-date-interval-from").attr("name",a+"[from]").val("");b.find("tr:last .bookacti-date-interval-to").attr("name",a+"[to]").val("")}
function bookacti_delete_days_off_row(a,b){b=b||null;var d=a.find("tbody");if(1>=d.find("tr").length)d.find("tr:first .bookacti-date-interval-from, tr:first .bookacti-date-interval-to").val("");else if(null!=b){b.remove();var f=0,c=a.data("name");d.find("tr").each(function(){var e=c+"["+f+"]";$j(this).find(".bookacti-date-interval-from").attr("name",e+"[from]");$j(this).find(".bookacti-date-interval-to").attr("name",e+"[to]");++f})}}
function bookacti_delete_days_off_rows(a){var b=a.find("tbody");b.find("tr:not(:first)").remove();bookacti_delete_days_off_row(a,b.find("tr:first"))};
