$j(document).ready(function(){$j(".qtranxs-translatable").on("keyup",function(){bookacti_update_qtx_field(this)});$j(".bookacti-tabs").tabs();$j(".bookacti-show-hide-advanced-options").on("click",function(){bookacti_show_hide_advanced_options($j(this))});$j("body").on("change",".bookacti-multiple-select-container .bookacti-multiple-select",function(){bookacti_switch_select_to_multiple(this)});bookacti_init_tooltip();$j("#bookacti-dismiss-5stars-rating").on("click",function(){bookacti_dismiss_5stars_rating_notice()});bookacti_select2_init();$j(".bookacti-backend-dialog").dialog({autoOpen:false,open:function(){if($j.ui&&$j.ui.dialog&&!$j.ui.dialog.prototype._allowInteractionRemapped&&$j(this).closest(".ui-dialog").length){if($j.ui.dialog.prototype._allowInteraction){$j.ui.dialog.prototype._allowInteraction=function(a){if($j(a.target).closest(".select2-drop").length){return true}if(typeof ui_dialog_interaction==="undefined"){return true}return ui_dialog_interaction.apply(this,arguments)};$j.ui.dialog.prototype._allowInteractionRemapped=true}else{$j.error("You must upgrade jQuery UI or else.")}}},_allowInteraction:function(a){return !((!$j(a.target).is(".select2-input"))||this._super(a))}});$j("body").on("keyup mouseup change",".bookacti-duration-field",function(){var c=$j(this).closest(".bookacti-duration-field-container").siblings(".bookacti-duration-value");var f=c.siblings(".bookacti-duration-field-container").find('.bookacti-duration-field[data-unit="day"]').val();var a=c.siblings(".bookacti-duration-field-container").find('.bookacti-duration-field[data-unit="hour"]').val();var b=c.siblings(".bookacti-duration-field-container").find('.bookacti-duration-field[data-unit="minute"]').val();var d="";if($j.isNumeric(f)||$j.isNumeric(a)||$j.isNumeric(b)){d=0;if($j.isNumeric(b)){d+=parseInt(b)*60}if($j.isNumeric(a)){d+=parseInt(a)*3600}if($j.isNumeric(f)){d+=parseInt(f)*86400}}c.val(d).trigger("change");$j(this).closest(".bookacti-duration-field-container").siblings(".bookacti-duration-hint").remove();if(!$j.isNumeric(d)){d=0}var e=moment.utc().add(d+bookacti_localized.utc_offset,"s").formatPHP(bookacti_localized.date_format_long);$j(this).closest(".bookacti-duration-field-container").parent().append('<div class="bookacti-duration-hint">'+e+"</div>")})});function bookacti_show_hide_advanced_options(b){var a=b.attr("for");var c=b.closest("form").find(".bookacti-hidden-field");if(a&&$j("#"+a).length){c=$j("#"+a)}b.toggleClass("bookacti-show-advanced-options bookacti-hide-advanced-options");if(b.hasClass("bookacti-show-advanced-options")){b.html(b.data("show-title"));c.hide(200,function(){if(b.closest("fieldset").length){b.closest("fieldset").addClass("bookacti-fieldset-no-css")}})}else{if(b.hasClass("bookacti-hide-advanced-options")){b.html(b.data("hide-title"));if(b.closest("fieldset").length){b.closest("fieldset").removeClass("bookacti-fieldset-no-css")}c.show(200)}}}function bookacti_init_add_and_remove_items(){$j(".bookacti-items-container").on("click",".bookacti-add-items",function(f){var d=$j(this).closest(".bookacti-items-container");var b=d.find(".bookacti-add-new-items-select-box");var c=b.is("[multiple]");var g=b.val();var a=g;if(!c){a=[g]}$j.each(a,function(h,e){d.find('.bookacti-add-new-items-select-box option[value="'+e+'"]').clone().appendTo(d.find(".bookacti-items-select-box"));d.find('.bookacti-add-new-items-select-box option[value="'+e+'"]').hide().attr("disabled",true);d.find(".bookacti-add-new-items-select-box").val(d.find(".bookacti-add-new-items-select-box option:enabled:first").val())});if(b.hasClass("bookacti-select2-no-ajax")){b.select2("destroy").select2()}});$j(".bookacti-items-container").on("click",".bookacti-remove-items",function(h){var f=$j(this).closest(".bookacti-items-container");var d=f.data("type");var g="";if(d==="users"){g=bookacti_localized.current_user_id}else{if(d==="templates"){g=bookacti.selected_template}}var b=f.find(".bookacti-add-new-items-select-box");var c=f.find(".bookacti-items-select-box").is("[multiple]");var i=f.find(".bookacti-items-select-box").val();var a=i;if(!c){a=[i]}$j.each(a,function(j,e){if(e!=g){f.find('.bookacti-items-select-box option[value="'+e+'"]').remove();f.find('.bookacti-add-new-items-select-box option[value="'+e+'"]').show().attr("disabled",false);f.find(".bookacti-add-new-items-select-box").val(e)}});if(b.hasClass("bookacti-select2-no-ajax")){b.select2("destroy").select2()}})}function bookacti_empty_all_dialog_forms(a){a=typeof a==="undefined"||!a?".bookacti-backend-dialog ":a+" ";$j(a+".bookacti-form-error").remove();$j(a+'input[type="hidden"]:not([name="action"]):not([name^="nonce"]):not([name="_wp_http_referer"]):not([name="qtranslate-edit-language"]):not(.bookacti-onoffswitch-hidden-input)').val("");$j(a+'input[type="text"]:not([readonly])').val("");$j(a+'input[type="email"]').val("");$j(a+'input[type="password"]').val("");$j(a+'input[type="tel"]').val("");$j(a+'input[type="number"]').val("");$j(a+'input[type="date"]').val("");$j(a+'input[type="time"]').val("");$j(a+"textarea").val("");$j(a+'input[type="color"]').val("#3a87ad");$j(a+'input[type="checkbox"]').prop("checked",false);$j(a+'input[type="radio"]').prop("checked",false);$j(a+"option").prop("selected",false);$j(a+".exception").remove();$j(a+"select.bookacti-add-new-items-select-box option").show().attr("disabled",false);$j(a+"select.bookacti-items-select-box option").remove();$j(a+".bookacti-duration-hint").remove();if($j(a+'input[type="file"]').length){$j(a+'input[type="file"]').each(function(){$j(this).wrap("<form>").closest("form").get(0).reset();$j(this).unwrap()})}if(typeof tinyMCE!=="undefined"){if(tinyMCE){$j(a+"textarea.wp-editor-area").each(function(){var b=$j(this).attr("id");if(tinyMCE.get(b)){tinyMCE.get(b).setContent("")}})}}if($j(a+".bookacti-multiple-select").length){$j(a+".bookacti-multiple-select").each(function(){bookacti_switch_select_to_multiple(this)})}$j("body").trigger("bookacti_empty_all_dialogs_forms",[a])}function bookacti_fill_fields_from_array(a,c,b){c=c||"";b=typeof b==="undefined"||!b?"":b+" ";$j.each(a,function(k,j){var g=c?c+"["+k+"]":k;if($j.isPlainObject(j)){bookacti_fill_fields_from_array(j,g,b);return true}if($j(b+'select[name="'+g+'[]"]').length&&(!$j.isArray(j)||($j.isArray(j)&&j.length<=1))){var n=$j(b+'select[name="'+g+'[]"]').attr("id");if($j(b+'input.bookacti-multiple-select[data-select-id="'+n+'"]').length){$j(b+'input.bookacti-multiple-select[data-select-id="'+n+'"]').prop("checked",false);bookacti_switch_select_to_multiple(b+'input.bookacti-multiple-select[data-select-id="'+n+'"]');$j(b+'select[name="'+g+'"] option').prop("selected",false)}}if($j(b+'select[name="'+g+'"]:not(.bookacti-items-select-box)').length&&$j.isArray(j)&&j.length>1){var n=$j(b+'select[name="'+g+'"]').attr("id");if($j(b+'input.bookacti-multiple-select[data-select-id="'+n+'"]').length){$j(b+'input.bookacti-multiple-select[data-select-id="'+n+'"]').prop("checked",true);bookacti_switch_select_to_multiple(b+'input.bookacti-multiple-select[data-select-id="'+n+'"]');$j(b+'select[name="'+g+'[]"] option').prop("selected",false)}}if($j(b+'input[type="checkbox"][name="'+g+'[]"]').length||$j(b+'input[type="checkbox"][name="'+g+'"]').length){if($j.isArray(j)){$j(b+'input[type="checkbox"][name="'+g+'[]"]').prop("checked",false);$j.each(j,function(p,o){$j(b+'input[type="checkbox"][name="'+g+'[]"][value="'+o+'"]').prop("checked",true).trigger("change")})}else{if(j==1){$j(b+'input[type="checkbox"][name="'+g+'"]').prop("checked",true).trigger("change")}else{$j(b+'input[type="checkbox"][name="'+g+'"]').prop("checked",false).trigger("change")}}}else{if($j(b+'input[name="'+g+'"]').is(":radio")){$j(b+'input[name="'+g+'"][value="'+j+'"]').prop("checked",true).trigger("change")}else{if($j(b+'select[name="'+g+'[]"].bookacti-items-select-box').length){if(!$j.isArray(j)){j=[j]}var l=$j(b+'select[name="'+g+'[]"].bookacti-items-select-box');var d=l.closest(".bookacti-items-container").find(".bookacti-add-new-items-select-box");d.find("option").show().attr("disabled",false);l.find("option").remove();$j.each(j,function(o,p){d.find('option[value="'+p+'"]').clone().appendTo(l);d.find('option[value="'+p+'"]').hide().attr("disabled",true);if(d.val()==p||!d.val()){d.val(d.find("option:enabled:first").val())}});if(l.find("option").length){l.find("option").prop("selected",true);l.trigger("change")}}else{if($j(b+'select[name="'+g+'"]').length){$j(b+'select[name="'+g+'"] option[value="'+j+'"]').prop("selected",true);$j(b+'select[name="'+g+'"]').trigger("change")}else{if($j(b+'select[name="'+g+'[]"]').length){if(!$j.isArray(j)){j=[j]}$j.each(j,function(o,p){$j(b+'select[name="'+g+'[]"] option[value="'+p+'"]').prop("selected",true)});$j(b+'select[name="'+g+'[]"]').trigger("change")}else{if($j(b+'input[name="'+g+'"]').attr("type")==="file"){return true}if($j(b+'input[name="'+g+'"]').attr("type")==="color"&&!j){j="#3a87ad"}if($j(b+'input[name="'+g+'"]').attr("type")==="time"&&parseInt(j.substr(0,2))>=24){j=bookacti_pad(parseInt(j.substr(0,2))%24,2)+j.substr(2)}$j(b+'input[name="'+g+'"]').val(j).trigger("change");$j(b+'textarea[name="'+g+'"]').val(j).trigger("change");if(typeof tinyMCE!=="undefined"){if(tinyMCE&&$j(b+'textarea[name="'+g+'"]').hasClass("wp-editor-area")){var e=$j(b+'textarea[name="'+g+'"]').attr("id");if(tinyMCE.get(e)){tinyMCE.get(e).setContent(j)}}}if($j(b+'input[name="'+g+'"].bookacti-duration-value').length){var m,i,f="";if($j.isNumeric(j)){var h=parseInt(j);if(h>=0){m=Math.floor(h/86400);h=h%86400;i=Math.floor(h/3600);h=h%3600;f=Math.floor(h/60)}}$j(b+'input[name="'+g+'"].bookacti-duration-value').siblings(".bookacti-duration-field-container").find('.bookacti-duration-field[data-unit="day"]').val(m).trigger("change");$j(b+'input[name="'+g+'"].bookacti-duration-value').siblings(".bookacti-duration-field-container").find('.bookacti-duration-field[data-unit="hour"]').val(i).trigger("change");$j(b+'input[name="'+g+'"].bookacti-duration-value').siblings(".bookacti-duration-field-container").find('.bookacti-duration-field[data-unit="minute"]').val(f).trigger("change")}}}}}}})}function bookacti_switch_select_to_multiple(e){if(!$j(e).length){return}var f=$j(e).data("select-id");var d=$j("select#"+f).attr("name");var a=$j(e).is(":checked");var b=$j("select#"+f).val();$j("select#"+f).prop("multiple",a);$j("select#"+f+' option[value="all"]').prop("disabled",a);$j("select#"+f+' option[value="none"]').prop("disabled",a);$j("select#"+f+' option[value="parent"]').prop("disabled",a);$j("select#"+f+' option[value="site"]').prop("disabled",a);$j("select#"+f+" option:disabled:selected").prop("selected",false);if(a&&d.indexOf("[]")<0){$j("select#"+f).attr("name",d+"[]");$j(e).closest(".bookacti-multiple-select-container").find("label span.dashicons").removeClass("dashicons-plus").addClass("dashicons-minus")}else{$j("select#"+f).attr("name",d.replace("[]",""));$j(e).closest(".bookacti-multiple-select-container").find("label span.dashicons").removeClass("dashicons-minus").addClass("dashicons-plus")}if(!a){var c=$j("select#"+f+" option:not(:disabled):first").length?$j("select#"+f+" option:not(:disabled):first").val():"";if(b){if(!$j.isArray(b)){b=[b]}$j.each(b,function(g,j){var h=$j("select#"+f+' option[value="'+j+'"]');if(h.length){if(!h.is(":disabled")){c=h.attr("value");return false}}})}$j("select#"+f).val(c).trigger("change")}if($j("select#"+f).hasClass("select2-hidden-accessible")){if(!$j.fn.select2){return}$j("select#"+f).select2("destroy");bookacti_select2_init()}}function bookacti_fill_items_selectbox(e,d,c){c=c||"users";if(!e.length||!d.length){return}var b=e.find(".bookacti-add-new-items-select-box");var f=e.find(".bookacti-items-select-box");if(!b.length||!f.length){return}var a=[];$j.each(d,function(h,g){if(b.find('option[value="'+g+'"]').length){b.find('option[value="'+g+'"]').clone().appendTo(f);b.find('option[value="'+g+'"]').hide().attr("disabled",true)}else{f.append('<option value="'+g+'" class="bookacti-unknown-item">'+g+"</option>");a.push(g)}if(b.val()==g||!b.val()){b.val(b.find("option:enabled:first").val())}});if(!a.length){return}$j.ajax({url:ajaxurl,type:"POST",data:{action:"bookactiSelect2Query_"+c,id__in:a,name:$j(this).attr("name")?$j(this).attr("name"):"",id:$j(this).attr("id")?$j(this).attr("id"):"",allow_current:$j(this).find('option[value="current"]').length?1:0,nonce:bookacti_localized.nonce_query_select2_options},dataType:"json",success:function(g){if(g.status==="success"){$j.each(g.options,function(j,k){f.find('.bookacti-unknown-item[value="'+k.id+'"]').html(k.text).removeClass("bookacti-unknown-item")})}else{if(g.status==="failed"){var h=typeof g.message!=="undefined"?g.message:bookacti_localized.error;console.log(h);console.log(g)}}},error:function(g){console.log("AJAX "+bookacti_localized.error);console.log(g)},complete:function(){}})}function bookacti_show_hide_template_related_options(b,a){var c=[];if($j.isNumeric(b)){b=[b]}if(!$j.isArray(b)){b=[]}a.prop("disabled",false);a.removeClass("bookacti-hide-fields");if($j.isEmptyObject(b)){return}a.each(function(){var f=$j(this);var e=f.data("bookacti-show-if-templates").toString();if(e.indexOf(",")>=0){e=e.split(",")}else{e=[e]}var d=true;$j.each(b,function(h,g){if($j.inArray(g.toString(),e)>=0){d=false}});if(d){if(f.is(":selected")){c.push(f)}f.addClass("bookacti-hide-fields");f.prop("disabled",true)}});$j.each(c,function(d,e){e.removeAttr("selected");e.siblings("option:not(.bookacti-hide-fields):not(:disabled):first").prop("selected",true)})}function bookacti_update_qtx_field(b){if(typeof qTranslateConfig!=="undefined"){var a=qTranslateConfig.js.get_qtx();var c=a.getActiveLanguage();var d=$j(b).attr("name");if(c!==undefined){$j('input[name="qtranslate-fields['+d+"]["+c+']"]').val($j(b).val())}}}function bookacti_refresh_qtx_field(c){if(typeof qTranslateConfig!=="undefined"){var a=qTranslateConfig.js.get_qtx();$j(c).removeClass("qtranxs-translatable");var b=a.refreshContentHook(c);$j(c).addClass("qtranxs-translatable");if(typeof tinyMCE!=="undefined"){if(tinyMCE&&$j("#"+c.id).hasClass("wp-editor-area")){if(tinyMCE.get(c.id)){b.mce=tinyMCE.get(c.id);b.mce.setContent(b.contentField.value,{format:"html"})}}}}}function bookacti_dismiss_5stars_rating_notice(){$j(".bookacti-5stars-rating-notice").remove();$j.ajax({url:ajaxurl,type:"POST",data:{action:"bookactiDismiss5StarsRatingNotice",nonce:bookacti_localized.nonce_dismiss_5stars_rating_notice},dataType:"json",success:function(a){if(a.status==="failed"){var b=typeof a.message!=="undefined"?a.message:bookacti_localized.error;console.log(b);console.log(a)}},error:function(a){console.log("AJAX "+bookacti_localized.error);console.log(a)},complete:function(){}})};