$j(document).ready(function(){$j("body").on("bookacti_perform_form_action",".bookacti-booking-system",function(){var a=$j(this);bookacti_wc_perform_form_action(a)})});function bookacti_wc_perform_form_action(b){var a=b.attr("id");var c=bookacti.booking_system[a];var d=c.form_action;if($j.inArray(d,["default","redirect_to_product_page","add_product_to_cart"])===-1){return}if(d==="default"&&b.closest("form.cart").length){if(b.closest("form.cart").find(".single_add_to_cart_button").length){b.closest("form.cart").find(".single_add_to_cart_button").trigger("click")}return}if(typeof c.picked_events[0]==="undefined"){return}var f=c.picked_events[0]["group_id"];var e=c.picked_events[0];if(d==="redirect_to_product_page"){if($j.isNumeric(f)){bookacti_redirect_to_group_category_product_page(b,f)}else{bookacti_redirect_to_activity_product_page(b,e)}}else{if(d==="add_product_to_cart"){if($j.isNumeric(f)){bookacti_add_group_category_product_to_cart(b,f)}else{console.log("add_product_to_cart",e);bookacti_add_activity_product_to_cart(b,e)}}}}function bookacti_redirect_to_activity_product_page(c,g){var b=c.attr("id");var d=bookacti.booking_system[b];if(typeof d.events_data[g.id]==="undefined"){return}var f=d.events_data[g.id]["activity_id"];if(typeof d.product_by_activity==="undefined"){return}if(typeof d.product_by_activity[f]==="undefined"){return}var e=d.product_by_activity[f];if(typeof d.products_page_url==="undefined"){return}if(typeof d.products_page_url[e]==="undefined"){return}var a=d.products_page_url[e];bookacti_redirect_booking_system_to_url(c,a)}function bookacti_redirect_to_group_category_product_page(c,g){var b=c.attr("id");var d=bookacti.booking_system[b];if(typeof d.groups_data[g]==="undefined"){return}var f=d.groups_data[g]["category_id"];if(typeof d.product_by_group_category==="undefined"){return}if(typeof d.product_by_group_category[f]==="undefined"){return}var e=d.product_by_group_category[f];if(typeof d.products_page_url==="undefined"){return}if(typeof d.products_page_url[e]==="undefined"){return}var a=d.products_page_url[e];bookacti_redirect_booking_system_to_url(c,a)}function bookacti_add_activity_product_to_cart(b,f){var a=b.attr("id");var c=bookacti.booking_system[a];if(typeof c.events_data[f.id]==="undefined"){return}var e=c.events_data[f.id]["activity_id"];if(typeof c.product_by_activity==="undefined"){return}if(typeof c.product_by_activity[e]==="undefined"){return}var d=c.product_by_activity[e];bookacti_add_product_to_cart_via_booking_system(b,d)}function bookacti_add_group_category_product_to_cart(b,f){var a=b.attr("id");var c=bookacti.booking_system[a];if(typeof c.groups_data[f]==="undefined"){return}var e=c.groups_data[f]["category_id"];if(typeof c.product_by_group_category==="undefined"){return}if(typeof c.product_by_group_category[e]==="undefined"){return}var d=c.product_by_group_category[e];bookacti_add_product_to_cart_via_booking_system(b,d)}function bookacti_add_product_to_cart_via_booking_system(b,d){var e=b.siblings(".bookacti-notices");if(b.closest("form").length){if(b.closest("form").find("> .bookacti-notices").length){e=b.closest("form").find("> .bookacti-notices")}}e.empty();var g=b.closest("form").length;if(!g){b.closest(".bookacti-form-fields").wrap('<form class="bookacti-temporary-form"></form>')}var f=b.closest("form");var a=f.find('input[name="action"]').length;var c=a?f.find('input[name="action"]').val():"";if(a){f.find('input[name="action"]').val("bookactiAddBoundProductToCart")}else{f.append('<input type="hidden" name="action" value="bookactiAddBoundProductToCart"/>')}var h=new FormData(f.get(0));if(a){f.find('input[name="action"]').val(c)}else{f.find('input[name="action"]').remove()}b.trigger("bookacti_before_add_product_to_cart",[h]);if(!g){b.closest(".bookacti-form-fields").unwrap("form.bookacti-temporary-form")}if(!(h instanceof FormData)){return}bookacti_start_loading_booking_system(b);$j.ajax({url:bookacti_localized.ajaxurl,type:"POST",data:h,dataType:"json",cache:false,contentType:false,processData:false,success:function(j){var i=typeof j.redirect_url!=="undefined"?j.redirect_url:"";if(j.status==="success"){if(i.indexOf("://")<0){bookacti_refresh_booking_numbers(b)}b.trigger("bookacti_product_added_to_cart",[j,h,d]);if(i){bookacti_start_loading_booking_system(b);window.location.replace(i);bookacti_stop_loading_booking_system(b)}}else{console.log(j)}if(j.messages){var l=j.status==="success"?"bookacti-success-list woocommerce":"bookacti-error-list";var k='<ul class="'+l+'"><li>'+j.messages+"</li></ul>";e.empty().append(k).show();if(!i){bookacti_scroll_to(e,500,"middle")}}},error:function(j){var i='<ul class="bookacti-error-list"><li>AJAX error occurred while trying to add the product to cart</li></ul>';e.empty().append(i).show();bookacti_scroll_to(e,500,"middle");console.log("AJAX error occurred while trying to add the product to cart");console.log(j)},complete:function(){bookacti_stop_loading_booking_system(b)}})};