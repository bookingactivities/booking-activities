$j(document).ready(function(){$j("body").on("bookacti_perform_form_action",".bookacti-booking-system",function(){var b=$j(this);bookacti_wc_perform_form_action(b)})});
function bookacti_wc_perform_form_action(b){var c=b.attr("id"),a=bookacti.booking_system[c];c=a.form_action;if(-1!==$j.inArray(c,["default","redirect_to_product_page","add_product_to_cart"]))if("default"===c&&b.closest("form.cart").length)b.closest("form.cart").find(".single_add_to_cart_button").length&&b.closest("form.cart").find(".single_add_to_cart_button").trigger("click");else{var d=b.closest(".bookacti-form-fields").length?b.closest(".bookacti-form-fields").find(".bookacti-quantity").length?
parseInt(b.closest(".bookacti-form-fields").find(".bookacti-quantity").val()):1:1,f=b.closest("form.cart").length?b.closest("form.cart").find('input[name="quantity"]').length?parseInt(b.closest("form.cart").find('input[name="quantity"]').val()):1:1;bookacti_validate_picked_events(b,Math.max(d,f))?(d=parseInt(a.picked_events[0].group_id),a=a.picked_events[0],"redirect_to_product_page"===c?0<d?bookacti_redirect_to_group_category_product_page(b,d):bookacti_redirect_to_activity_product_page(b,a.id):"add_product_to_cart"===
c&&bookacti_add_product_to_cart_via_booking_system(b)):bookacti_scroll_to(b.siblings(".bookacti-notices"),500,"middle")}}
function bookacti_redirect_to_activity_product_page(b,c){var a=b.attr("id");a=bookacti.booking_system[a];"undefined"!==typeof a.events_data[c]&&(c=a.events_data[c].activity_id,"undefined"!==typeof a.product_by_activity&&"undefined"!==typeof a.product_by_activity[c]&&(c=a.product_by_activity[c],"undefined"!==typeof a.products_page_url&&"undefined"!==typeof a.products_page_url[c]&&bookacti_redirect_booking_system_to_url(b,a.products_page_url[c])))}
function bookacti_redirect_to_group_category_product_page(b,c){var a=b.attr("id");a=bookacti.booking_system[a];"undefined"!==typeof a.groups_data[c]&&(c=a.groups_data[c].category_id,"undefined"!==typeof a.product_by_group_category&&"undefined"!==typeof a.product_by_group_category[c]&&(c=a.product_by_group_category[c],"undefined"!==typeof a.products_page_url&&"undefined"!==typeof a.products_page_url[c]&&bookacti_redirect_booking_system_to_url(b,a.products_page_url[c])))}
function bookacti_add_product_to_cart_via_booking_system(b){var c=b.closest("form").length;c||b.closest(".bookacti-form-fields").wrap('<form class="bookacti-temporary-form"></form>');var a=b.closest("form"),d=a.find('input[type="submit"]');d.length&&d.prop("disabled",!0);var f=a.find("> .bookacti-notices").length?a.find("> .bookacti-notices"):b.siblings(".bookacti-notices");f.empty();var k=a.find('input[name="action"]').length,l=k?a.find('input[name="action"]').val():"";k?a.find('input[name="action"]').val("bookactiAddBoundProductToCart"):
a.append('<input type="hidden" name="action" value="bookactiAddBoundProductToCart"/>');var g={form_data:new FormData(a.get(0))};b.trigger("bookacti_before_add_product_to_cart",[g]);k?a.find('input[name="action"]').val(l):a.find('input[name="action"]').remove();c||b.closest(".bookacti-form-fields").unwrap("form.bookacti-temporary-form");if(!(g.form_data instanceof FormData))return d.length&&d.prop("disabled",!1),!1;bookacti_start_loading_booking_system(b);d.length&&bookacti_add_loading_html(d,"after");
$j.ajax({url:bookacti_localized.ajaxurl,type:"POST",data:g.form_data,dataType:"json",cache:!1,contentType:!1,processData:!1,success:function(e){var h="undefined"!==typeof e.redirect_url?e.redirect_url:"";"success"===e.status?(0>h.indexOf("://")&&bookacti_refresh_booking_numbers(b),b.trigger("bookacti_product_added_to_cart",[e,g]),h&&(bookacti_start_loading_booking_system(b),window.location.replace(h),bookacti_stop_loading_booking_system(b))):console.log(e);e.messages&&(e='<ul class="'+("success"===
e.status?"bookacti-success-list woocommerce":"bookacti-error-list")+'"><li>'+e.messages+"</li></ul>",f.empty().append(e).show(),h||bookacti_scroll_to(f,500,"middle"))},error:function(e){f.empty().append('<ul class="bookacti-error-list"><li>AJAX error occurred while trying to add the product to cart</li></ul>').show();bookacti_scroll_to(f,500,"middle");console.log("AJAX error occurred while trying to add the product to cart");console.log(e)},complete:function(){d.length&&(bookacti_remove_loading_html(d.parent()),
d.prop("disabled",!1));bookacti_stop_loading_booking_system(b)}})};
