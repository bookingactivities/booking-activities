$j(document).ready(function(){$j("body").on("bookacti_submit_booking_form",".bookacti-booking-form",function(){var a=$j(this).find(".bookacti-booking-system");bookacti_wc_perform_form_action(a)});$j("body").on("bookacti_events_picked_after",".bookacti-booking-system",function(i,h,g){var b=$j(this);var a=b.attr("id");var c=bookacti.booking_system[a];if(!b.closest("#bookacti-form-editor-page-form").length){if(h==="single"&&c.when_perform_form_action==="on_event_click"){var d=bookacti_get_event_group_ids(b,g);var f=false;if($j.isArray(d)&&((d.length>1)||(d.length===1&&c.groups_single_events))){f=true}if(!f){bookacti_wc_perform_form_action(b)}}}b.trigger("bookacti_events_picked_after_wc",[h,g])});$j("body").on("bookacti_group_of_events_chosen_after",".bookacti-booking-system",function(g,f,d){var b=$j(this);var a=b.attr("id");var c=bookacti.booking_system[a];if(!b.closest("#bookacti-form-editor-page-form").length){if(c.when_perform_form_action==="on_event_click"){bookacti_wc_perform_form_action(b)}}b.trigger("bookacti_group_of_events_chosen_after_wc",[f,d])})});function bookacti_wc_perform_form_action(b){var a=b.attr("id");if(typeof bookacti.booking_system[a]==="undefined"){return}var c=bookacti.booking_system[a];if(typeof c.form_action!=="undefined"){return}var d=c.form_action;if($j.inArray(d,["default","redirect_to_product_page","add_product_to_cart"])===-1){return}var f=b.siblings(".bookacti-booking-system-inputs").find('input[name="bookacti_group_id"]').val();var e={id:b.siblings(".bookacti-booking-system-inputs").find('input[name="bookacti_event_id"]').val(),start:b.siblings(".bookacti-booking-system-inputs").find('input[name="bookacti_event_start"]').val(),end:b.siblings(".bookacti-booking-system-inputs").find('input[name="bookacti_event_end"]').val()};if(d==="default"&&b.closest("form.cart").length){if(b.closest("form.cart").find(".single_add_to_cart_button").length){b.closest("form.cart").find(".single_add_to_cart_button").trigger("click")}return}if(f==="single"&&e.id&&e.start&&e.end){if(d==="redirect_to_product_page"){bookacti_redirect_to_activity_product_page(b,e)}else{if(d==="add_product_to_cart"){bookacti_add_activity_product_to_cart(b,e)}}}else{if($j.isNumeric(f)){if(d==="redirect_to_product_page"){bookacti_redirect_to_group_category_product_page(b,f)}else{if(d==="add_product_to_cart"){bookacti_add_group_category_product_to_cart(b,f)}}}}}function bookacti_redirect_to_activity_product_page(c,g){var b=c.attr("id");var d=bookacti.booking_system[b];if(typeof d.events_data[g.id]==="undefined"){return}var f=d.events_data[g.id]["activity_id"];if(typeof d.product_by_activity==="undefined"){return}if(typeof d.product_by_activity[f]==="undefined"){return}var e=d.product_by_activity[f];if(typeof d.products_page_url==="undefined"){return}if(typeof d.products_page_url[e]==="undefined"){return}var a=d.products_page_url[e];bookacti_redirect_booking_system_to_url(c,a)}function bookacti_redirect_to_group_category_product_page(c,g){var b=c.attr("id");var d=bookacti.booking_system[b];if(typeof d.groups_data[g]==="undefined"){return}var f=d.groups_data[g]["category_id"];if(typeof d.product_by_group_category==="undefined"){return}if(typeof d.product_by_group_category[f]==="undefined"){return}var e=d.product_by_group_category[f];if(typeof d.products_page_url==="undefined"){return}if(typeof d.products_page_url[e]==="undefined"){return}var a=d.products_page_url[e];bookacti_redirect_booking_system_to_url(c,a)}function bookacti_add_activity_product_to_cart(b,f){var a=b.attr("id");var c=bookacti.booking_system[a];if(typeof c.events_data[f.id]==="undefined"){return}var e=c.events_data[f.id]["activity_id"];if(typeof c.product_by_activity==="undefined"){return}if(typeof c.product_by_activity[e]==="undefined"){return}var d=c.product_by_activity[e];bookacti_add_product_to_cart_via_booking_system(b,d)}function bookacti_add_group_category_product_to_cart(b,f){var a=b.attr("id");var c=bookacti.booking_system[a];if(typeof c.groups_data[f]==="undefined"){return}var e=c.groups_data[f]["category_id"];if(typeof c.product_by_group_category==="undefined"){return}if(typeof c.product_by_group_category[e]==="undefined"){return}var d=c.product_by_group_category[e];bookacti_add_product_to_cart_via_booking_system(b,d)}function bookacti_add_product_to_cart_via_booking_system(a,b){var c=a.siblings(".bookacti-notices");if(a.closest("form").length){if(a.closest("form").find("> .bookacti-notices").length){c=a.closest("form").find("> .bookacti-notices")}}c.empty();var d=[];if(!a.closest("form").length){a.closest(".bookacti-form-fields").wrap('<form class="bookacti-temporary-form"></form>');d=new FormData(a.closest("form").get(0));a.closest(".bookacti-form-fields").unwrap("form.bookacti-temporary-form")}else{d=new FormData(a.closest("form").get(0))}a.trigger("bookacti_before_add_product_to_cart",[d]);if(d instanceof FormData){d.set("action","bookactiAddBoundProductToCart")}else{return}bookacti_start_loading_booking_system(a);$j.ajax({url:bookacti_localized.ajaxurl,type:"POST",data:d,dataType:"json",cache:false,contentType:false,processData:false,success:function(f){var e=typeof f.redirect_url!=="undefined"?f.redirect_url:"";if(f.status==="success"){if(e.indexOf("://")<0){bookacti_refresh_booking_numbers(a)}a.trigger("bookacti_product_added_to_cart",[f,d,b]);if(e){bookacti_start_loading_booking_system(a);window.location.replace(e);bookacti_stop_loading_booking_system(a)}}else{console.log(f)}if(f.messages){var h=f.status==="success"?"bookacti-success-list woocommerce":"bookacti-error-list";var g='<ul class="'+h+'"><li>'+f.messages+"</li></ul>";c.empty().append(g).show();if(!e){bookacti_scroll_to(c,500,"middle")}}},error:function(g){var f='<ul class="bookacti-error-list"><li>AJAX error occured while trying to add the product to cart</li></ul>';c.empty().append(f).show();bookacti_scroll_to(c,500,"middle");console.log("AJAX error occured while trying to add the product to cart");console.log(g)},complete:function(){bookacti_stop_loading_booking_system(a)}})};