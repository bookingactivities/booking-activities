$j(document).ready(function(){$j("body").on("bookacti_perform_form_action",".bookacti-booking-system",function(){var a=$j(this);bookacti_wc_perform_form_action(a)})});
function bookacti_wc_perform_form_action(a){var c=a.attr("id"),b=bookacti.booking_system[c];c=b.form_action;if(-1!==$j.inArray(c,["default","redirect_to_product_page","add_product_to_cart"]))if("default"===c&&a.closest("form.cart").length)a.closest("form.cart").find(".single_add_to_cart_button").length&&a.closest("form.cart").find(".single_add_to_cart_button").trigger("click");else{var d=a.closest(".bookacti-form-fields").length?a.closest(".bookacti-form-fields").find(".bookacti-quantity").length?
parseInt(a.closest(".bookacti-form-fields").find(".bookacti-quantity").val()):1:1,f=a.closest("form.cart").length?a.closest("form.cart").find('input[name="quantity"]').length?parseInt(a.closest("form.cart").find('input[name="quantity"]').val()):1:1;bookacti_validate_picked_events(a,Math.max(d,f))?(d=parseInt(b.picked_events[0].group_id),b=b.picked_events[0],"redirect_to_product_page"===c?0<d?bookacti_redirect_to_group_category_product_page(a,d):bookacti_redirect_to_activity_product_page(a,b.id):"add_product_to_cart"===
c&&bookacti_add_product_to_cart_via_booking_system(a)):bookacti_scroll_to(a.siblings(".bookacti-notices"),500,"middle")}}
function bookacti_redirect_to_activity_product_page(a,c){var b=a.attr("id");b=bookacti.booking_system[b];"undefined"!==typeof b.events_data[c]&&(c=b.events_data[c].activity_id,"undefined"!==typeof b.product_by_activity&&"undefined"!==typeof b.product_by_activity[c]&&(c=b.product_by_activity[c],"undefined"!==typeof b.products_page_url&&"undefined"!==typeof b.products_page_url[c]&&bookacti_redirect_booking_system_to_url(a,b.products_page_url[c])))}
function bookacti_redirect_to_group_category_product_page(a,c){var b=a.attr("id");b=bookacti.booking_system[b];"undefined"!==typeof b.groups_data[c]&&(c=b.groups_data[c].category_id,"undefined"!==typeof b.product_by_group_category&&"undefined"!==typeof b.product_by_group_category[c]&&(c=b.product_by_group_category[c],"undefined"!==typeof b.products_page_url&&"undefined"!==typeof b.products_page_url[c]&&bookacti_redirect_booking_system_to_url(a,b.products_page_url[c])))}
function bookacti_add_product_to_cart_via_booking_system(a){var c=a.closest("form").length;c||a.closest(".bookacti-form-fields").wrap('<form class="bookacti-temporary-form"></form>');var b=a.closest("form"),d=b.find('input[type="submit"]');d.length&&d.prop("disabled",!0);var f=b.find("> .bookacti-notices").length?b.find("> .bookacti-notices"):a.siblings(".bookacti-notices");f.empty();var g={form_data:new FormData(b.get(0))};a.trigger("bookacti_before_add_product_to_cart",[g]);c||a.closest(".bookacti-form-fields").unwrap("form.bookacti-temporary-form");
if(!(g.form_data instanceof FormData))return d.length&&d.prop("disabled",!1),!1;g.form_data.set("action","bookactiAddBoundProductToCart");bookacti_start_loading_booking_system(a);d.length&&bookacti_add_loading_html(d,"after");$j.ajax({url:bookacti_localized.ajaxurl,type:"POST",data:g.form_data,dataType:"json",cache:!1,contentType:!1,processData:!1,success:function(e){var h="undefined"!==typeof e.redirect_url?e.redirect_url:"";"success"===e.status?(0>h.indexOf("://")&&bookacti_refresh_booking_numbers(a),
a.trigger("bookacti_product_added_to_cart",[e,g]),h&&(bookacti_start_loading_booking_system(a),window.location.assign(h),bookacti_stop_loading_booking_system(a))):console.log(e);e.message&&(e='<ul class="'+("success"===e.status?"bookacti-success-list woocommerce":"bookacti-error-list")+'"><li>'+e.message+"</li></ul>",f.empty().append(e).show(),h||bookacti_scroll_to(f,500,"middle"))},error:function(e){f.empty().append('<ul class="bookacti-error-list"><li>AJAX error occurred while trying to add the product to cart</li></ul>').show();
bookacti_scroll_to(f,500,"middle");console.log("AJAX error occurred while trying to add the product to cart");console.log(e)},complete:function(){d.length&&(bookacti_remove_loading_html(d.parent()),d.prop("disabled",!1));bookacti_stop_loading_booking_system(a)}})};
