$j(document).ready(function(){$j(".woocommerce").on("bookacti_booking_action_data",".woocommerce-table tr.order_item",function(a,b,c,f,d){a=!1;"undefined"!==typeof b.form_data&&b.form_data instanceof FormData&&(a=!0);a?b.form_data.append("context","wc_order_items"):b.context="wc_order_items"});"undefined"===typeof bookacti.form_fields&&(bookacti.form_fields=[]);$j(".woocommerce").on("bookacti_init_booking_sytem","form.cart.variations_form .bookacti-booking-system",function(a,b,c){!1!==b.load&&"undefined"!==
typeof $j(this).closest(".bookacti-wc-form-fields")&&$j(this).closest(".bookacti-wc-form-fields").data("default-variation-id")&&(b.load=!1)});$j(".woocommerce").on("reset_data","form.cart.variations_form",function(){if($j(this).find(".bookacti-wc-form-fields").length){var a=$j(this).find(".bookacti-wc-form-fields");a.data("form-id","");a.attr("data-form-id","");a.data("variation-id","");a.attr("data-variation-id","");a.empty()}});$j(".woocommerce").on("show_variation","form.cart.variations_form",
function(a,b){$j(this).find(".bookacti-wc-form-fields").length&&(a=$j(this).find(".bookacti-wc-form-fields"),bookacti_switch_product_variation_form(a,b),b=b.bookacti_is_activity?bookacti_localized.add_booking_to_cart_button_text:bookacti_localized.add_product_to_cart_button_text,$j(this).find(".single_add_to_cart_button").text(b))});$j(".woocommerce").on("bookacti_displayed_info_cleared","form.cart .bookacti-booking-system",function(){$j(this).closest("form").find('input[name="quantity"]').attr("disabled",
!1);$j(this).closest("form").find('button[type="submit"]').attr("disabled",!1)});$j(".woocommerce").on("bookacti_error_displayed","form.cart .bookacti-booking-system",function(){$j(this).closest("form").find('input[name="quantity"]').attr("disabled",!0);$j(this).closest("form").find('button[type="submit"]').attr("disabled",!0)});if($j(".woocommerce form.cart .single_add_to_cart_button").length)$j(".woocommerce form.cart").on("submit",function(){var a=$j(this),b=!1;if(a.hasClass("variations_form")){var c=
a.find(".variation_id").val();""!==c&&"undefined"!==typeof c&&(b=bookacti.is_variation_activity[c])}else a.find(".bookacti-booking-system-container").length&&(b=!0);if(b){if(a.hasClass("bookacti-adding-to-cart"))return a.find('button[type="submit"]').attr("disabled",!0),!1;if(a.find(".bookacti-booking-system").length){if(bookacti_validate_picked_events(a.find(".bookacti-booking-system"),a.find("input.qty").val())){b={form_data:new FormData(a.get(0))};a.trigger("bookacti_before_submit_booking_form",
[b]);if(!(b.form_data instanceof FormData))return!1;a.addClass("bookacti-adding-to-cart");return!0}bookacti_scroll_to(a.find(".bookacti-booking-system-container .bookacti-notices"),500,"middle");return!1}}});$j(".woocommerce").on("keyup mouseup change","form.cart input.qty",function(){var a=$j(this),b=a.closest("form").length?a.closest("form"):a.closest(".bookacti-form-fields");b.length&&("undefined"!==typeof bookacti_quantity_change_monitor&&bookacti_quantity_change_monitor&&clearTimeout(bookacti_quantity_change_monitor),
bookacti_quantity_change_monitor=setTimeout(function(){var c=b.find(".bookacti-booking-system");c.length&&(bookacti_set_min_and_max_quantity(c),bookacti_fill_picked_events_list(c));b.trigger("bookacti_booking_form_quantity_change",[a.val(),a])},1E3))});$j(".bookacti-wc-form-fields-reset").each(function(){var a=$j(this).find(".bookacti-booking-system");a.length&&(bookacti_clear_booking_system_displayed_info(a),($j(this).find("> .bookacti-notices").length?$j(this).find("> .bookacti-notices"):a.siblings(".bookacti-notices")).empty())});
$j(".woocommerce").on("bookacti_before_refresh_total_price_field","form.cart",function(a,b){b.form_data instanceof FormData&&(!$j(this).find('[name="product_id"]').length&&$j(this).find('[name="add-to-cart"]').length&&b.form_data.set("product_id",$j(this).find('[name="add-to-cart"]').val()),b.form_data.delete("add-to-cart"))});$j(".bookacti-countdown").length&&setInterval(bookacti_countdown,1E3);$j(document).on("qv_loader_stop",function(){var a=$j("#yith-quick-view-modal"),b=a.find(" .bookacti-booking-system");
b.length&&!a.find(" .variations_form").length&&bookacti_reload_booking_system(b)})});
function bookacti_switch_product_variation_form(a,b){a.empty();if(b.bookacti_is_activity&&b.is_in_stock&&b.variation_is_active&&b.variation_is_visible){bookacti.is_variation_activity[b.variation_id]=!0;var c=parseInt(b.bookacti_form_id);if(c)if("undefined"!==typeof bookacti.form_fields[c])bookacti_fill_product_variation_form(a,b,bookacti.form_fields[c]);else{bookacti_add_loading_html(a);var f={action:"bookactiGetForm",form_id:c,instance_id:"product-variation-"+b.variation_id,context:"wc_switch_variation"},
d=!0;$j.each(b.attributes,function(e,g){if(g!==bookacti_get_url_parameter(e))return d=!1});d&&(f=$j.param(f),f=window.location.search.substring(1)+"&"+f);$j.ajax({url:bookacti_localized.ajaxurl,type:"POST",data:f,dataType:"json",success:function(e){"success"===e.status?(bookacti.form_fields[c]=e.form_html,bookacti_fill_product_variation_form(a,b,e.form_html)):(console.log("undefined"!==typeof e.message?e.message:bookacti_localized.error),console.log(e))},error:function(e){console.log("AJAX "+bookacti_localized.error);
console.log(e)},complete:function(){bookacti_remove_loading_html(a)}})}}}
function bookacti_fill_product_variation_form(a,b,c){a.empty();a.append(c);a.data("form-id",b.bookacti_form_id);a.attr("data-form-id",b.bookacti_form_id);a.data("variation-id",b.variation_id);a.attr("data-variation-id",b.variation_id);c=a.find(".bookacti-booking-system");bookacti_booking_method_set_up(c,!1);bookacti_init_jquery_ui_dialogs(".bookacti-booking-system-dialog");bookacti_init_tooltip();a.hasClass("bookacti-wc-form-fields-reset")&&(bookacti_clear_booking_system_displayed_info(c),(a.find("> .bookacti-notices").length?
a.find("> .bookacti-notices"):c.siblings(".bookacti-notices")).empty());bookacti_remove_loading_html(c);a.trigger("bookacti_product_variation_form_switched",[b])}
function bookacti_countdown(){$j(".bookacti-countdown").each(function(){if($j(this).hasClass("bookacti-expired"))return $j(this).html(bookacti_localized.expired),!0;var a=$j(this).data("expiration-date");if(!a)return!0;a=moment.utc(a);var b=moment.utc(),c=a.diff(b,"seconds");a=Math.max(Math.floor(c/86400),0);c-=86400*a;b=Math.max(Math.floor(c/3600)%24,0);c-=3600*b;var f=Math.max(Math.floor(c/60)%60,0);c=Math.max((c-60*f)%60,0);var d="";if(0<a){var e=bookacti_localized.days;1===a&&(e=bookacti_localized.day);
d+=a+" "+e+" "}if(0<b||0<a)d+=b+":";d+=bookacti_pad(f,2)+":"+bookacti_pad(c,2);if(0===a&&0===b&&0===f&&0===c){d=bookacti_localized.expired;$j(this).addClass("bookacti-expired");var g=this;setTimeout(function(){bookacti_refresh_cart_after_expiration(g)},2E3)}$j(this).html(d)})}
function bookacti_refresh_cart_after_expiration(a){var b=$j(a).closest(".checkout").length,c=$j(a).closest(".woocommerce"),f=c.find("form").attr("action");$j(a).closest(".bookacti-cart-expiration-container").length&&$j(a).closest(".bookacti-cart-expiration-container").html(bookacti_localized.error_cart_expired);b||($j(a).hasClass("bookacti-cart-expiration")?c.find(".bookacti-cart-item-expires-with-cart").closest(".cart_item").empty():$j(a).closest(".cart_item").empty(),c.find(".cart-subtotal .amount, .shipping .amount, .order-total .amount, .includes_tax .amount").empty());
$j.ajax({url:f,type:"POST",data:{},dataType:"html",success:function(d){b?$j("body").trigger("update_checkout"):0>=$j(d).find(".woocommerce form").length?c.html($j(d).find(".woocommerce").html()):($j(d).find(".woocommerce-error").length&&(c.find(".woocommerce-error").length?$j(d).find(".woocommerce-error li").clone().appendTo(c.find(".woocommerce-error")):$j(d).find(".woocommerce-error").clone().prependTo(c)),c.find(".cart-subtotal .amount").html($j(d).find(".cart-subtotal .amount").html()),c.find(".shipping .amount").html($j(d).find(".shipping .amount").html()),
c.find(".order-total .amount").html($j(d).find(".order-total .amount").html()),c.find(".includes_tax .amount").html($j(d).find(".includes_tax .amount").html()))},error:function(d){console.log("AJAX "+bookacti_localized.error);console.log(d)},complete:function(){}})};
