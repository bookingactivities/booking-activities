if(typeof $j==="undefined"){$j=jQuery.noConflict()}$j(document).ready(function(){$j("body").on("mouseover","#woocommerce-order-items tr.item",function(a){$j(this).find(".bookacti-order-item-action-buttons").show()});$j("body").on("mouseout","#woocommerce-order-items tr.item",function(a){$j(this).find(".bookacti-order-item-action-buttons").hide()});$j(".type_box select, .type_box input").on("change",function(){bookacti_show_hide_activity_tab()});bookacti_show_hide_activity_tab();$j("#woocommerce-product-data").on("change","#_bookacti_form, .bookacti_variable_form",function(b){var a=$j('.bookacti-form-selectbox-link[data-form-selectbox-id="'+$j(this).attr("id")+'"] a');if(!a.length){return}if($j(this).val()==0){a.parent().hide()}else{a.attr("href",bookacti_localized.admin_url+"admin.php?page=bookacti_forms&action=edit&form_id="+$j(this).val());a.parent().show()}});$j("#woocommerce-product-data").on("click",".bookacti-show-deprecated",function(a){a.preventDefault();$j(".bookacti-deprecated-hidden").toggle()});$j("#woocommerce-product-data").on("woocommerce_variations_loaded",function(){bookacti_show_hide_activity_variation_fields();$j("#woocommerce-product-data .bookacti_variable_template").each(function(){var b=$j(this).val();if(b==="parent"){b=$j("#_bookacti_template").val()||$j(this).data("parent")}var a=$j('[name$="['+$j(this).data("loop")+']"] [data-bookacti-show-if-templates], [name$="['+$j(this).data("loop")+'][]"] [data-bookacti-show-if-templates]');bookacti_show_hide_template_related_options_deprecated(b,a)})});$j("#woocommerce-product-data").on("change",".bookacti_variable_is_activity",function(){bookacti_show_hide_activity_variation_fields(this)});$j("#woocommerce-product-data").on("change",".bookacti_variable_template",function(){var b=$j(this).val();if(b==="parent"){b=$j("#_bookacti_template").val()||$j(this).data("parent")}var a=$j('[name$="['+$j(this).data("loop")+']"] [data-bookacti-show-if-templates], [name$="['+$j(this).data("loop")+'][]"] [data-bookacti-show-if-templates]');bookacti_show_hide_template_related_options_deprecated(b,a)});$j("#woocommerce-product-data").on("change",".variable_is_virtual",function(){if($j(this).parents(".options").find(".bookacti_variable_is_activity").is(":checked")){if(!$j(this).is(":checked")){$j(this).prop("checked",true).trigger("change")}}});$j("#woocommerce-product-data").on("click",".bookacti-generate-product-booking-form, .bookacti-generate-variation-booking-form",function(d){d.preventDefault();var b=$j("#post_ID").val();var c=0;if($j(this).hasClass("bookacti-generate-variation-booking-form")){var a=$j(this).data("loop");c=$j('input[name="variable_post_id['+a+']"]').val()}bookacti_migrate_product_activity_settings_to_booking_form(b,c,$j(this))});$j(".bookacti-user-booking-list, .woocommerce-table, #bookacti-booking-list").on("click",".bookacti-booking-action, .bookacti-booking-group-action",function(c){c.preventDefault();if($j(this).hasClass("bookacti-delete-booking")||$j(this).hasClass("bookacti-delete-booking-group")){$j(".bookacti-delete-wc-order-item-container select").val("none")}var d=false;if($j(this).hasClass("bookacti-delete-booking")){var b=$j(this).data("booking-id");if($j('.bookacti-view-booking-order[data-booking-id="'+b+'"]').length&&!$j('.bookacti-view-booking-order[data-booking-id="'+b+'"]').parents(".bookacti-gouped-booking").length){d=true}}else{if($j(this).hasClass("bookacti-delete-booking-group")){var a=$j(this).data("booking-group-id");if($j('.bookacti-view-booking-order[data-booking-group-id="'+a+'"]').length){d=true}}}if(d){$j(".bookacti-delete-wc-order-item-container").show()}else{$j(".bookacti-delete-wc-order-item-container").hide()}});$j("#woocommerce-product-data").on("keyup mouseup change","#_regular_price",function(a){bookacti_show_hide_empty_price_notice()});$j("#woocommerce-product-data").on("keyup mouseup change",'.woocommerce_variation .wc_input_price[name^="variable_regular_price["]',function(b){var a=$j(this).closest(".woocommerce_variation").find(".variation_menu_order").length?$j(this).closest(".woocommerce_variation").find(".variation_menu_order").val():0;bookacti_show_hide_empty_price_notice(a)});$j("#woocommerce-product-data").on("change","#product-type",function(a){bookacti_show_hide_empty_price_notice()});$j("#woocommerce-product-data").on("change","#_bookacti_is_activity",function(a){bookacti_show_hide_empty_price_notice()});$j("#woocommerce-product-data").on("change",".woocommerce_variation .bookacti_variable_is_activity",function(b){var a=$j(this).closest(".woocommerce_variation").find(".variation_menu_order").length?$j(this).closest(".woocommerce_variation").find(".variation_menu_order").val():0;bookacti_show_hide_empty_price_notice(a)});bookacti_show_hide_empty_price_notice();$j("#woocommerce-product-data").on("woocommerce_variations_loaded",function(){$j("#woocommerce-product-data .woocommerce_variation").each(function(){var a=$j(this).find(".variation_menu_order").length?$j(this).find(".variation_menu_order").val():0;bookacti_show_hide_empty_price_notice(a)})})});function bookacti_show_hide_activity_tab(){$j(".bookacti_show_if_activity").hide();if($j("#_bookacti_is_activity").is(":checked")){if($j('label[for="_bookacti_is_activity"]').is(":visible")){$j(".bookacti_show_if_activity").show();if(!$j("#_virtual").is(":checked")){$j("#_virtual").prop("checked",true).trigger("change")}}$j(".bookacti_hide_if_activity").hide()}else{$j(".bookacti_hide_if_activity").show();if($j("#_virtual").is(":checked")){$j(".bookacti_hide_if_activity.hide_if_virtual").hide()}}}function bookacti_show_hide_activity_variation_fields(a){a=a||undefined;if(a===undefined){$j(".show_if_variation_activity").hide();$j(".bookacti_variable_is_activity").each(function(){if($j(this).is(":checked")){$j(this).parents(".woocommerce_variation").find(".show_if_variation_activity").show()}})}else{if($j(a).is(":checked")){$j(a).parents(".woocommerce_variation").find(".show_if_variation_activity").show();if(!$j(a).parents(".options").find(".variable_is_virtual").is("checked")){$j(a).parents(".options").find(".variable_is_virtual").prop("checked",true).trigger("change")}}else{$j(a).parents(".woocommerce_variation").find(".show_if_variation_activity").hide()}}}function bookacti_show_hide_empty_price_notice(c){c=parseInt(c)||"product";$j("#woocommerce-product-data .bookacti-empty-product-price-notice").remove();var d='<div class="bookacti-empty-product-price-notice">You must set a price for your product, otherwise the booking form wonâ€™t appear on the product page.</div>';if(c==="product"){var b=$j.isNumeric($j("#_regular_price").val())?parseFloat($j("#_regular_price").val()):"";if(!b&&b!==0&&b!=="0"&&$j("#_bookacti_is_activity").is(":checked")){$j("#_regular_price, #_bookacti_form").after(d)}}else{if(c){var e=c-1;var a=$j.isNumeric($j('input[name="variable_regular_price['+e+']"]').val())?parseFloat($j('input[name="variable_regular_price['+e+']"]').val()):"";if(!a&&a!==0&&a!=="0"&&$j("#bookacti_variable_is_activity_"+e).is(":checked")){$j('input[name="variable_regular_price['+e+']"], #bookacti_variable_form_'+e).after(d)}}}}function bookacti_migrate_product_activity_settings_to_booking_form(c,d,b){var a=b.parent();a.find(".bookacti-notices").remove();var e='<div class="bookacti-loading-alt"><img class="bookacti-loader" src="'+bookacti_localized.plugin_path+'/img/ajax-loader.gif" title="'+bookacti_localized.loading+'" /><span class="bookacti-loading-alt-text" >'+bookacti_localized.loading+"</span></div>";b.after(e);$j.ajax({url:ajaxurl,type:"POST",data:{action:"bookactiMigrateProductSettings",product_id:c,variation_id:d},dataType:"json",success:function(g){if(typeof g.form_id!=="undefined"){var f="";if(d){f=$j("#bookacti_variable_form_"+b.data("loop"))}else{f=$j("#_bookacti_form")}if(f.length){f.append('<option value="'+g.form_id+'">'+g.form_title+"</option>");f.find('option[value="'+g.form_id+'"]').prop("selected",true).trigger("change")}}if(typeof g.message!=="undefined"){var h="";if(g.status==="failed"){h="bookacti-error-list"}if(g.status==="warning"){h="bookacti-warning-list"}if(g.status==="success"){h="bookacti-success-list"}b.after('<div class="bookacti-notices"><ul class="'+h+'"><li>'+g.message+"</li></ul></div>")}if(g.status==="success"){b.remove()}else{console.log(g)}},error:function(f){console.log("AJAX "+bookacti_localized.error_create_form);console.log(f)},complete:function(){a.find(".bookacti-notices").show();a.find(".bookacti-loading-alt").remove()}})}function bookacti_show_hide_template_related_options_deprecated(b,a){var c=[];if($j.isNumeric(b)){b=[b]}a.prop("disabled",false);a.removeClass("bookacti-hide-fields");a.each(function(){var f=$j(this);var e=f.data("bookacti-show-if-templates").toString();if(e.indexOf(",")>=0){e=e.split(",")}else{e=[e]}var d=true;$j.each(b,function(h,g){if($j.inArray(g.toString(),e)>=0){d=false}});if(d){if(f.is(":selected")){c.push(f)}f.addClass("bookacti-hide-fields");f.prop("disabled",true)}});$j.each(c,function(d,e){e.removeAttr("selected");e.siblings("option:not(.bookacti-hide-fields):not(:disabled):first").prop("selected",true)})};