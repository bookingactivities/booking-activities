$j(document).ready(function(){bookacti_init_booking_actions();$j(".bookacti-bookings-bulk-action").length&&bookacti_init_booking_bulk_actions();$j(".bookacti-export-bookings-button").on("click",function(){bookacti_dialog_export_bookings()});$j("#bookacti-export-bookings-dialog").dialog({beforeClose:function(){}});$j('.bookacti_export_button input[type="button"]').on("click",function(){var b=$j(this).closest(".bookacti_export_url").find(".bookacti_export_url_field input").val();b&&window.open(b,"_blank")});
$j("#bookacti-export-bookings-dialog").on("tabsactivate",".bookacti-tabs",function(b,a){bookacti_change_export_type_according_to_active_tab()})});
function bookacti_dialog_update_bookings_calendar_settings(){$j("#bookacti-bookings-calendar-settings-dialog").dialog("option","buttons",[{text:bookacti_localized.dialog_button_ok,click:function(){$j("#bookacti-bookings-calendar-settings-dialog .bookacti-notices").remove();var b=$j("#bookacti-bookings-calendar-settings-form").serializeObject();$j("body").trigger("bookacti_bookings_calendar_settings_data",[b]);bookacti_add_loading_html($j("#bookacti-bookings-calendar-settings-dialog"));$j.ajax({url:bookacti_localized.ajaxurl,
type:"POST",data:b,dataType:"json",success:function(a){if("success"===a.status){bookacti.booking_system["bookacti-booking-system-bookings-page"].display_data=a.display_data;bookacti.booking_system["bookacti-booking-system-bookings-page"].tooltip_booking_list=a.calendar_settings.tooltip_booking_list;bookacti.booking_system["bookacti-booking-system-bookings-page"].tooltip_booking_list_columns=a.calendar_settings.booking_list_columns;$j("body").trigger("bookacti_bookings_calendar_settings_updated",[b,
a]);var d=$j("#bookacti-booking-system-bookings-page");bookacti_reload_booking_system(d,!0);$j("#bookacti-submit-filter-button").attr("data-ajax",a.calendar_settings.ajax).data("ajax",a.calendar_settings.ajax);$j("#bookacti-bookings-calendar-settings-dialog").dialog("close")}else if("failed"===a.status){d="undefined"!==typeof a.message?a.message:"";if(!d){d+="Error while trying to update calendar settings";var c="undefined"!==typeof a.error?a.error:"";c&&(d+=" ("+c+")")}$j("#bookacti-bookings-calendar-settings-dialog").append('<div class="bookacti-notices"><ul class="bookacti-error-list"><li>'+
d+"</li></ul></div>");console.log(d);console.log(a)}},error:function(a){$j("#bookacti-bookings-calendar-settings-dialog").append('<div class="bookacti-notices"><ul class="bookacti-error-list"><li>AJAX error while trying to update calendar settings</li></ul></div>');console.log("AJAX error while trying to update calendar settings");console.log(a)},complete:function(){$j("#bookacti-bookings-calendar-settings-dialog .bookacti-notices").show();bookacti_remove_loading_html($j("#bookacti-bookings-calendar-settings-dialog"))}})}},
{text:bookacti_localized.dialog_button_cancel,click:function(){$j(this).dialog("close")}}]);$j("#bookacti-bookings-calendar-settings-dialog").dialog("open")}
function bookacti_dialog_cancel_booking(b,a){a="group"===a?"group":"single";var d="group"===a?"bookactiCancelBookingGroup":"bookactiCancelBooking";$j("#bookacti-cancel-booking-dialog").dialog("option","buttons",[{text:bookacti_localized.dialog_button_cancel_booking,"class":"bookacti-dialog-delete-button",click:function(){$j("#bookacti-cancel-booking-dialog .bookacti-notices").remove();if("single"===a){var c=$j('.bookacti-cancel-booking[data-booking-id="'+b+'"]').closest("tr");var k=$j('.bookacti-cancel-booking[data-booking-id="'+
b+'"]').closest("tr, .bookacti-booking-row")}else c=$j('.bookacti-cancel-booking-group[data-booking-group-id="'+b+'"]').closest("tr"),k=$j('.bookacti-cancel-booking-group[data-booking-group-id="'+b+'"]').closest("tr, .bookacti-booking-row");var l=[];c.first().find("td").each(function(){var f=$j(this).data("column-id");f&&l.push(f)});var e={action:d,booking_id:b,context:bookacti_localized.is_admin?"admin_booking_list":"user_booking_list",columns:l,nonce:bookacti_localized.nonce_cancel_booking};c.first().trigger("bookacti_booking_action_data",
[e,b,a,"cancel"]);bookacti_add_loading_html($j("#bookacti-cancel-booking-dialog"));bookacti_booking_row_enter_loading_state(k);$j.ajax({url:bookacti_localized.ajaxurl,type:"POST",data:e,dataType:"json",success:function(f){if("success"===f.status)f.row&&(c.last().after(f.row),c.remove(),bookacti_refresh_list_table_hidden_columns()),$j("#bookacti-cancel-booking-dialog").dialog("close"),f.allow_refund&&bookacti_dialog_refund_booking(b,a),$j("body").trigger("bookacti_booking_cancelled_by_user",[b,a]);
else if("failed"===f.status){var m="undefined"!==typeof f.message?f.message:bookacti_localized.error;$j("#bookacti-cancel-booking-dialog").append('<div class="bookacti-notices"><ul class="bookacti-error-list"><li>'+m+"</li></ul></div>");console.log(m);console.log(f)}},error:function(f){$j("#bookacti-cancel-booking-dialog").append('<div class="bookacti-notices"><ul class="bookacti-error-list"><li>AJAX '+bookacti_localized.error+"</li></ul></div>");console.log("AJAX "+bookacti_localized.error);console.log(f)},
complete:function(){$j("#bookacti-cancel-booking-dialog .bookacti-notices").show();bookacti_remove_loading_html($j("#bookacti-cancel-booking-dialog"));bookacti_booking_row_exit_loading_state(k)}})}},{text:bookacti_localized.dialog_button_cancel,click:function(){$j(this).dialog("close")}}]);$j("#bookacti-cancel-booking-dialog").dialog("open")}
function bookacti_dialog_refund_booking(b,a){a="group"===a?"group":"single";var d="group"===a?"bookactiGetBookingGroupRefundActionsHTML":"bookactiGetBookingRefundActionsHTML",c="group"===a?"bookactiRefundBookingGroup":"bookactiRefundBooking";$j("#bookacti-refund-booking-dialog #bookacti-refund-options").empty();$j("#bookacti-refund-booking-dialog #bookacti-refund-options-container").hide();$j("#bookacti-refund-booking-dialog #bookacti-no-refund-option").hide();$j("#bookacti-refund-booking-dialog #bookacti-refund-amount").empty();
$j("#bookacti-refund-booking-dialog #bookacti-refund-amount-container").hide();bookacti_add_loading_html($j("#bookacti-refund-booking-dialog"));$j.ajax({url:bookacti_localized.ajaxurl,type:"POST",data:{action:d,booking_id:b,is_admin:bookacti_localized.is_admin?1:0,nonce:bookacti_localized.nonce_refund_booking},dataType:"json",success:function(k){if("success"===k.status){var l=[];k.actions_html?($j("#bookacti-refund-booking-dialog #bookacti-refund-options").html(k.actions_html),$j("#bookacti-refund-booking-dialog #bookacti-refund-options-container").show(),
k.amount&&($j("#bookacti-refund-booking-dialog #bookacti-refund-amount").html(k.amount),$j("#bookacti-refund-booking-dialog #bookacti-refund-amount-container").show()),$j('#bookacti-refund-booking-form input[type="radio"]:first').prop("checked",!0),l.push({text:bookacti_localized.dialog_button_refund,"class":"bookacti-dialog-delete-button",click:function(){$j("#bookacti-refund-booking-dialog .bookacti-notices").remove();if("single"===a){var e=$j('.bookacti-refund-booking[data-booking-id="'+b+'"]').closest("tr");
var f=$j('.bookacti-refund-booking[data-booking-id="'+b+'"]').closest("tr, .bookacti-booking-row")}else e=$j('.bookacti-refund-booking-group[data-booking-group-id="'+b+'"]').closest("tr"),f=$j('.bookacti-refund-booking-group[data-booking-group-id="'+b+'"]').closest("tr, .bookacti-booking-row");var m=0;e.first().closest("#bookacti-booking-list").length&&(m=e.next().hasClass("bookacti-gouped-booking")?1:0);f.find(".bookacti-booking-state").hide();bookacti_add_loading_html(f.find(".bookacti-booking-state"),
"after");bookacti_add_loading_html($j("#bookacti-refund-booking-dialog"));var g=$j('#bookacti-refund-booking-form input[name="refund-action"]:checked').val(),n=$j('#bookacti-refund-message textarea[name="refund-message"]').val(),p=[];e.first().find("td").each(function(){var h=$j(this).data("column-id");h&&p.push(h)});var q={action:c,booking_id:b,refund_action:g,refund_message:n,reload_grouped_bookings:m,is_admin:bookacti_localized.is_admin?1:0,context:bookacti_localized.is_admin?"admin_booking_list":
"user_booking_list",columns:p,nonce:bookacti_localized.nonce_refund_booking};e.first().trigger("bookacti_booking_action_data",[q,b,a,"refund"]);$j.ajax({url:bookacti_localized.ajaxurl,type:"POST",data:q,dataType:"json",success:function(h){if("success"===h.status)m&&"undefined"!==typeof h.grouped_booking_rows&&e.each(function(){var t=$j(this).next().hasClass("hidden");$j(this).nextUntil("tr:not(.bookacti-gouped-booking)").remove();$j(this).after(h.grouped_booking_rows);t&&($j(this).nextUntil("tr:not(.bookacti-gouped-booking)").addClass("hidden"),
$j(this).nextUntil("tr:not(.bookacti-gouped-booking)").length%2&&$j(this).after('<tr class="bookacti-gouped-booking hidden dummy"></tr>'))}),h.row&&(e.last().after(h.row),e.remove(),bookacti_refresh_list_table_hidden_columns()),$j("body").trigger("bookacti_booking_refunded",[b,a,g,n,h]),$j("#bookacti-refund-booking-dialog").dialog("close"),h.message&&bookacti_dialog_refund_confirmation(h.message);else if("failed"===h.status){var r="undefined"!==typeof h.message?h.message:bookacti_localized.error;
$j("#bookacti-refund-booking-dialog").append('<div class="bookacti-notices"><ul class="bookacti-error-list"><li>'+r+"</li></ul></div>");console.log(r);console.log(h)}},error:function(h){console.log("AJAX "+bookacti_localized.error);console.log(h)},complete:function(){$j("#bookacti-refund-booking-dialog .bookacti-notices").show();bookacti_remove_loading_html($j("#bookacti-refund-booking-dialog"));bookacti_remove_loading_html(f);f.find(".bookacti-booking-state").show()}})}})):$j("#bookacti-refund-booking-dialog #bookacti-no-refund-option").show();
l.push({text:bookacti_localized.dialog_button_cancel,click:function(){$j(this).dialog("close")}});$j("#bookacti-refund-booking-dialog").dialog("option","buttons",l)}else"failed"===k.status&&(l="undefined"!==typeof k.message?k.message:bookacti_localized.error,$j("#bookacti-refund-booking-dialog").append('<div class="bookacti-notices"><ul class="bookacti-error-list"><li>'+l+"</li></ul></div>"),console.log(l),console.log(k))},error:function(k){console.log("AJAX "+bookacti_localized.error);console.log(k)},
complete:function(){bookacti_remove_loading_html($j("#bookacti-refund-booking-dialog"));$j("#bookacti-refund-booking-dialog .bookacti-notices").show()}});$j("#bookacti-refund-booking-dialog").dialog("open")}
function bookacti_dialog_refund_confirmation(b){$j("#bookacti-refund-booking-confirm-dialog").html(b);$j("#bookacti-refund-booking-confirm-dialog").dialog("option","buttons",[{text:bookacti_localized.dialog_button_ok,click:function(){$j(this).dialog("close")}}]);$j("#bookacti-refund-booking-confirm-dialog").dialog("open")}
function bookacti_dialog_change_booking_state(b,a){a="group"===a?"group":"single";var d="group"===a?"bookactiChangeBookingGroupState":"bookactiChangeBookingState";var c="single"===a?$j('.bookacti-change-booking-state[data-booking-id="'+b+'"]').closest("tr"):$j('.bookacti-change-booking-group-state[data-booking-group-id="'+b+'"]').closest("tr");var k=c.first().closest("#bookacti-booking-list").length?1:0,l=k&&c.next().hasClass("bookacti-gouped-booking")?1:0,e=c.first().find(".bookacti-booking-state").data("booking-state"),
f=c.first().find(".bookacti-payment-status").data("payment-status");e&&$j("select#bookacti-select-booking-state").val(e);f&&$j("select#bookacti-select-payment-status").val(f);$j("#bookacti-send-notifications-on-state-change").prop("checked",!1);$j("#bookacti-change-booking-state-dialog").dialog("option","buttons",[{text:bookacti_localized.dialog_button_ok,click:function(){var m=$j("select#bookacti-select-booking-state").val(),g=$j("select#bookacti-select-payment-status").val(),n=$j("#bookacti-send-notifications-on-state-change").prop("checked")?
1:0,p=$j('#bookacti-change-booking-state-dialog input[name="nonce"]').val();if((m||g)&&(m!==e||g!==f)){$j("#bookacti-change-booking-state-dialog .bookacti-notices").remove();var q=[];c.first().find("td").each(function(){var h=$j(this).data("column-id");h&&q.push(h)});n={action:d,booking_id:b,new_booking_state:e!==m?m:0,new_payment_status:g,send_notifications:n,is_bookings_page:k,is_admin:bookacti_localized.is_admin?1:0,context:bookacti_localized.is_admin?"admin_booking_list":"user_booking_list",columns:q,
reload_grouped_bookings:l,nonce:p};c.first().trigger("bookacti_booking_action_data",[n,b,a,"change_state"]);bookacti_booking_row_enter_loading_state(c);bookacti_add_loading_html($j("#bookacti-change-booking-state-dialog"));$j.ajax({url:bookacti_localized.ajaxurl,type:"POST",data:n,dataType:"json",success:function(h){if("success"===h.status)$j("#bookacti-change-booking-state-dialog").dialog("close"),l&&"undefined"!==typeof h.grouped_booking_rows&&c.each(function(){var t=$j(this).next().hasClass("hidden");
$j(this).nextUntil("tr:not(.bookacti-gouped-booking)").remove();$j(this).after(h.grouped_booking_rows);t&&($j(this).nextUntil("tr:not(.bookacti-gouped-booking)").addClass("hidden"),$j(this).nextUntil("tr:not(.bookacti-gouped-booking)").length%2&&$j(this).after('<tr class="bookacti-gouped-booking hidden dummy"></tr>'))}),h.row&&(c.last().after(h.row),c.remove(),bookacti_refresh_list_table_hidden_columns()),e!==m&&$j("body").trigger("bookacti_booking_state_changed",[b,a,m,e,k,h.active_changed]),f!==
g&&$j("body").trigger("bookacti_payment_status_changed",[b,a,g,f,k,h.active_changed]);else if("failed"===h.status){var r="undefined"!==typeof h.message?h.message:bookacti_localized.error;$j("#bookacti-change-booking-state-dialog").append('<div class="bookacti-notices"><ul class="bookacti-error-list"><li>'+r+"</li></ul></div>").show();console.log(r);console.log(h)}},error:function(h){$j("#bookacti-change-booking-state-dialog").append('<div class="bookacti-notices"><ul class="bookacti-error-list"><li>AJAX '+
bookacti_localized.error+"</li></ul></div>").show();console.log("AJAX "+bookacti_localized.error);console.log(h)},complete:function(){$j("#bookacti-change-booking-state-dialog .bookacti-notices").show();bookacti_remove_loading_html($j("#bookacti-change-booking-state-dialog"));bookacti_booking_row_exit_loading_state(c)}})}}},{text:bookacti_localized.dialog_button_cancel,click:function(){$j(this).dialog("close")}}]);$j("#bookacti-change-booking-state-dialog").dialog("open")}
function bookacti_dialog_change_booking_quantity(b,a){a="group"===a?"group":"single";var d="single"===a?$j('.bookacti-change-booking-quantity[data-booking-id="'+b+'"]').closest("tr"):$j('.bookacti-change-booking-group-quantity[data-booking-group-id="'+b+'"]').closest("tr");var c=d.first().closest("#bookacti-booking-list").length?1:0,k=c&&d.next().hasClass("bookacti-gouped-booking")?1:0,l=parseInt(d.first().find(".column-quantity").text());$j("#bookacti-new-quantity").val(l);d.first().trigger("bookacti_booking_action_dialog_opened",
[b,a,"change_quantity"]);$j("#bookacti-change-booking-quantity-dialog").dialog("option","buttons",[{text:bookacti_localized.dialog_button_ok,click:function(){var e=parseInt($j("#bookacti-new-quantity").val());if(e){$j("#bookacti-change-booking-quantity-dialog .bookacti-notices").remove();var f=[];d.first().find("td").each(function(){var g=$j(this).data("column-id");g&&f.push(g)});var m=$j("#bookacti-change-booking-quantity-form").serializeObject();m.action="group"===a?"bookactiChangeBookingGroupQuantity":
"bookactiChangeBookingQuantity";m.booking_id=b;m.is_bookings_page=c;m.is_admin=bookacti_localized.is_admin?1:0;m.context=bookacti_localized.is_admin?"admin_booking_list":"user_booking_list";m.columns=f;m.reload_grouped_bookings=k;d.first().trigger("bookacti_booking_action_data",[m,b,a,"change_quantity"]);bookacti_booking_row_enter_loading_state(d);bookacti_add_loading_html($j("#bookacti-change-booking-quantity-dialog"));$j.ajax({url:bookacti_localized.ajaxurl,type:"POST",data:m,dataType:"json",success:function(g){if("success"===
g.status)$j("#bookacti-change-booking-quantity-dialog").dialog("close"),k&&"undefined"!==typeof g.grouped_booking_rows&&d.each(function(){var p=$j(this).next().hasClass("hidden");$j(this).nextUntil("tr:not(.bookacti-gouped-booking)").remove();$j(this).after(g.grouped_booking_rows);p&&($j(this).nextUntil("tr:not(.bookacti-gouped-booking)").addClass("hidden"),$j(this).nextUntil("tr:not(.bookacti-gouped-booking)").length%2&&$j(this).after('<tr class="bookacti-gouped-booking hidden dummy"></tr>'))}),
g.row&&(d.last().after(g.row),d.remove(),bookacti_refresh_list_table_hidden_columns()),$j("body").trigger("bookacti_booking_quantity_changed",[b,a,e,l,c,g.active_changed]);else if("failed"===g.status){var n="undefined"!==typeof g.message?g.message:bookacti_localized.error;$j("#bookacti-change-booking-quantity-dialog").append('<div class="bookacti-notices"><ul class="bookacti-error-list"><li>'+n+"</li></ul></div>").show();console.log(n);console.log(g)}},error:function(g){$j("#bookacti-change-booking-quantity-dialog").append('<div class="bookacti-notices"><ul class="bookacti-error-list"><li>AJAX '+
bookacti_localized.error+"</li></ul></div>").show();console.log("AJAX "+bookacti_localized.error);console.log(g)},complete:function(){$j("#bookacti-change-booking-quantity-dialog .bookacti-notices").show();bookacti_remove_loading_html($j("#bookacti-change-booking-quantity-dialog"));bookacti_booking_row_exit_loading_state(d)}})}}},{text:bookacti_localized.dialog_button_cancel,click:function(){$j(this).dialog("close")}}]);$j("#bookacti-change-booking-quantity-dialog").dialog("open")}
function bookacti_dialog_reschedule_booking(b){var a=$j('.bookacti-reschedule-booking[data-booking-id="'+b+'"]').closest("tr"),d=$j('.bookacti-reschedule-booking[data-booking-id="'+b+'"]').closest("tr, .bookacti-booking-row"),c=$j("#bookacti-booking-system-reschedule.bookacti-booking-system"),k=c.attr("id"),l=0;bookacti_localized.is_admin&&$j("#bookacti-send-notifications-on-reschedule").prop("checked",!1);c.empty();bookacti_clear_booking_system_displayed_info(c);bookacti_booking_row_enter_loading_state(d);
$j.ajax({url:bookacti_localized.ajaxurl,type:"POST",data:{action:"bookactiGetRescheduleBookingSystemData",booking_id:b,is_admin:bookacti_localized.is_admin?1:0},dataType:"json",success:function(e){if("success"===e.status){var f=c.attr("id");l=e.booking_system_data.rescheduled_booking_data.quantity;c.closest("form").find("input.bookacti-quantity").val(l);bookacti.booking_system[f]=e.booking_system_data;c.trigger("bookacti_before_reschedule_booking_system_loads",[e]);bookacti_reload_booking_system(c)}else"failed"===
e.status&&(f="undefined"!==typeof e.message?e.message:bookacti_localized.error,c.siblings(".bookacti-notices").html("<ul class='bookacti-error-list'><li>"+f+"</li></ul>").show(),console.log(f),console.log(e));$j("#bookacti-reschedule-booking-dialog").dialog("open")},error:function(e){console.log("AJAX "+bookacti_localized.error);console.log(e)},complete:function(){bookacti_booking_row_exit_loading_state(d)}});$j("#bookacti-reschedule-booking-dialog").dialog("option","buttons",[{text:bookacti_localized.dialog_button_reschedule,
"class":"bookacti-dialog-delete-button",click:function(){if(bookacti_validate_picked_events(c,l)){var e=bookacti.booking_system[k].picked_events;if(!(0<parseInt(e[0].group_id))){var f=1;bookacti_localized.is_admin&&$j("#bookacti-send-notifications-on-reschedule").length&&(f=$j("#bookacti-send-notifications-on-reschedule").prop("checked")?1:0);var m=[];a.first().find("td").each(function(){var g=$j(this).data("column-id");g&&m.push(g)});e={action:"bookactiRescheduleBooking",booking_id:b,picked_events:e,
columns:m,context:bookacti_localized.is_admin?"admin_booking_list":"user_booking_list",is_admin:bookacti_localized.is_admin?1:0,send_notifications:f,nonce:bookacti_localized.nonce_reschedule_booking};a.first().trigger("bookacti_booking_action_data",[e,b,"single","reschedule"]);bookacti_booking_row_enter_loading_state(d);bookacti_start_loading_booking_system(c);bookacti_add_loading_html($j("#bookacti-reschedule-booking-dialog"));$j.ajax({url:bookacti_localized.ajaxurl,type:"POST",data:e,dataType:"json",
success:function(g){if("success"===g.status)$j("#bookacti-reschedule-booking-dialog").dialog("close"),g.row&&(a.last().after(g.row),a.remove(),bookacti_refresh_list_table_hidden_columns()),$j("body").trigger("bookacti_booking_rescheduled",[g]);else{var n="undefined"!==typeof g.message?g.message:bookacti_localized.error;c.siblings(".bookacti-notices").html("<ul class='bookacti-error-list'><li>"+n+"</li></ul>").show();console.log(n);console.log(g)}},error:function(g){console.log("AJAX "+bookacti_localized.error);
console.log(g)},complete:function(){bookacti_remove_loading_html($j("#bookacti-reschedule-booking-dialog"));bookacti_booking_row_exit_loading_state(d);bookacti_stop_loading_booking_system(c)}})}}}},{text:bookacti_localized.dialog_button_cancel,click:function(){$j(this).dialog("close")}}])}
function bookacti_dialog_delete_booking(b,a){a="group"===a?"group":"single";if("single"===a){var d="bookactiDeleteBooking";var c=$j('.bookacti-delete-booking[data-booking-id="'+b+'"]').closest("tr");$j(".bookacti-delete-booking-group-description").hide()}else d="bookactiDeleteBookingGroup",c=$j('.bookacti-delete-booking-group[data-booking-group-id="'+b+'"]').closest("tr"),$j(".bookacti-delete-booking-group-description").show();$j('#bookacti-delete-booking-dialog input[name="action"]').val(d);$j('#bookacti-delete-booking-dialog input[name="booking_id"]').val(b);
$j('#bookacti-delete-booking-dialog input[name="booking_type"]').val(a);$j("#bookacti-delete-booking-dialog").dialog("option","buttons",[{text:bookacti_localized.dialog_button_delete,"class":"bookacti-dialog-delete-button",click:function(){$j("#bookacti-delete-booking-dialog .bookacti-notices").remove();var k=$j("#bookacti-delete-booking-dialog form").serializeObject();k.is_admin=bookacti_localized.is_admin?1:0;k.context=bookacti_localized.is_admin?"admin_booking_list":"user_booking_list";c.first().trigger("bookacti_booking_action_data",
[k,b,a,"delete"]);bookacti_booking_row_enter_loading_state(c);bookacti_add_loading_html($j("#bookacti-delete-booking-dialog"));$j.ajax({url:bookacti_localized.ajaxurl,type:"POST",data:k,dataType:"json",success:function(l){if("success"===l.status){$j("#bookacti-delete-booking-dialog").dialog("close");if("group"===a&&$j(".bookacti-booking-group-id-"+b).length){var e=$j(".bookacti-booking-group-id-"+b);e.removeClass("bookacti-gouped-booking").animate({opacity:0},function(){e.children("td, th").animate({padding:0}).wrapInner("<div></div>").children().slideUp(function(){e.remove()})})}c.animate({opacity:0},
function(){c.children("td, th").animate({padding:0}).wrapInner("<div></div>").children().slideUp(function(){c.remove()})});$j("body").trigger("bookacti_booking_deleted",[b,a,l])}else if("failed"===l.status){var f="undefined"!==typeof l.message?l.message:bookacti_localized.error;$j("#bookacti-delete-booking-dialog").append('<div class="bookacti-notices"><ul class="bookacti-error-list"><li>'+f+"</li></ul></div>");console.log(f);console.log(l)}},error:function(l){$j("#bookacti-delete-booking-dialog").append('<div class="bookacti-notices"><ul class="bookacti-error-list"><li>AJAX '+
bookacti_localized.error+"</li></ul></div>");console.log("AJAX "+bookacti_localized.error);console.log(l)},complete:function(){$j("#bookacti-delete-booking-dialog .bookacti-notices").show();bookacti_remove_loading_html($j("#bookacti-delete-booking-dialog"));bookacti_booking_row_exit_loading_state(c)}})}},{text:bookacti_localized.dialog_button_cancel,"class":"bookacti-dialog-left-button",click:function(){$j(this).dialog("close")}}]);$j("#bookacti-delete-booking-dialog").dialog("open")}
function bookacti_dialog_export_bookings(){$j("#bookacti-export-bookings-url-container").data("export-type","");bookacti_change_export_type_according_to_active_tab();$j("#bookacti_export_bookings_url_secret").val("");$j("#bookacti-export-bookings-url-container").hide();$j("#bookacti-export-bookings-dialog").dialog("option","buttons",[{text:bookacti_localized.dialog_button_generate_link,click:function(){bookacti_generate_export_bookings_url(!1)}},{text:bookacti_localized.dialog_button_reset,"class":"bookacti-dialog-delete-button bookacti-dialog-left-button",
click:function(){bookacti_generate_export_bookings_url(!0)}}]);$j("#bookacti-export-bookings-dialog").dialog("open")}
function bookacti_generate_export_bookings_url(b){b=b||!1;$j("#bookacti-export-bookings-dialog .bookacti-notices").remove();bookacti_add_loading_html($j("#bookacti-export-bookings-dialog"));var a=$j("#bookacti-export-bookings-form").serializeObject();a.action="bookactiExportBookingsUrl";a.reset_key=b?1:0;a.booking_filters=$j("#bookacti-booking-list-filters-form").serializeObject();$j("#bookacti-export-bookings-form").trigger("bookacti_export_bookings_url_data",[a,b]);$j.ajax({url:ajaxurl,type:"POST",
data:a,dataType:"json",success:function(d){if("success"===d.status)$j("#bookacti_export_bookings_url_secret").val(d.url),$j("#bookacti-export-bookings-dialog").append('<div class="bookacti-notices"><ul class="bookacti-success-list"><li>'+d.message+"</li></ul></div>").show(),$j("#bookacti-export-bookings-url-container").data("export-type",a.export_type),$j("#bookacti-export-bookings-url-container").show(),$j("#bookacti-form-editor").trigger("bookacti_export_bookings_url",[d]);else if("failed"===d.status){var c=
"undefined"!==typeof d.message?d.message:bookacti_localized.error;$j("#bookacti-export-bookings-dialog").append('<div class="bookacti-notices"><ul class="bookacti-error-list"><li>'+c+"</li></ul></div>").show();console.log(c);console.log(d)}},error:function(d){$j("#bookacti-export-bookings-dialog").append('<div class="bookacti-notices"><ul class="bookacti-error-list"><li>AJAX '+bookacti_localized.error+"</li></ul></div>").show();console.log("AJAX "+bookacti_localized.error);console.log(d)},complete:function(){$j("#bookacti-export-bookings-dialog .bookacti-notices").show();
bookacti_remove_loading_html($j("#bookacti-export-bookings-dialog"))}})};
