$j(document).ready(function(){var b=$j("#bookacti-booking-system-bookings-page");var a=b.attr("id");if(!b.length){return false}bookacti_update_template_related_filters();$j("body").on("bookacti_init_booking_sytem",".bookacti-booking-system#bookacti-booking-system-bookings-page",function(f,d,c){if(!$j("#bookacti-booking-system-filter-container").is(":visible")){d.load=false}});$j("#bookacti-booking-filter-templates, #bookacti-booking-filter-status, #bookacti-booking-filter-customer").on("change",function(){bookacti_update_template_related_filters();if($j("#bookacti-booking-system-filter-container").is(":visible")){var c=$j("#bookacti-booking-system-bookings-page");bookacti_reload_booking_system_according_to_filters(c)}if($j("#bookacti-submit-filter-button").data("ajax")){bookacti_filter_booking_list()}});$j("#bookacti-pick-event-filter").on("click",function(){var d=$j("#bookacti-booking-system-bookings-page");if(!$j("#bookacti-booking-system-filter-container").is(":visible")){var c=d.attr("id");var h=$j("#bookacti-booking-filter-templates").val()?$j("#bookacti-booking-filter-templates").val():[];var f=$j("#bookacti-booking-filter-status").val()?$j("#bookacti-booking-filter-status").val():[];var e=$j("#bookacti-booking-filter-customer").val()?$j("#bookacti-booking-filter-customer").val():0;if(!bookacti_compare_arrays(bookacti.booking_system[c]["calendars"],h)||!bookacti_compare_arrays(bookacti.booking_system[c]["status"],f)||bookacti.booking_system[c]["user_id"]!==e){bookacti_reload_booking_system_according_to_filters(d)}var g=$j("#bookacti-pick-event-filter").data("label-hide");$j("#bookacti-pick-event-filter").text(g).attr("title",g);$j("#bookacti-pick-event-filter-instruction").show(200)}else{var g=$j("#bookacti-pick-event-filter").data("label-show");$j("#bookacti-pick-event-filter").text(g).attr("title",g);$j("#bookacti-pick-event-filter-instruction").hide(200)}$j("#bookacti-booking-system-filter-container").toggle(200)});$j("#bookacti-unpick-events-filter").on("click",function(){bookacti_unpick_all_events_filter();if($j("#bookacti-submit-filter-button").data("ajax")){bookacti_filter_booking_list()}});$j("#bookacti-booking-system-bookings-page").on("bookacti_event_click",function(g,f,c,d){$j("#bookacti-pick-event-filter-instruction").hide(200);$j("#bookacti-unpick-events-filter").show(200);$j("#bookacti-picked-events-actions-container").show(200)});$j("#bookacti-booking-system-bookings-page").on("bookacti_event_click",function(g,f,c,d){if($j.isEmptyObject(c)||!d){if($j("#bookacti-submit-filter-button").data("ajax")){bookacti_filter_booking_list()}}});$j("#bookacti-booking-system-bookings-page").on("bookacti_group_of_events_chosen",function(f,d,g,c){if($j("#bookacti-submit-filter-button").data("ajax")){bookacti_filter_booking_list()}});$j("#bookacti-booking-filter-activities").on("change",function(){bookacti_unpick_all_events_filter();bookacti_booking_method_rerender_events($j("#bookacti-booking-system-bookings-page"));if($j("#bookacti-submit-filter-button").data("ajax")){bookacti_filter_booking_list()}});$j("#bookacti-booking-filter-dates-from, #bookacti-booking-filter-dates-to").on("change",function(){bookacti_unpick_all_events_filter();bookacti_refresh_calendar_according_to_date_filter();if($j("#bookacti-submit-filter-button").data("ajax")){bookacti_filter_booking_list()}});b.on("bookacti_calendar_event_class_names",function(i,c,h){var g=typeof h.event.groupId!=="undefined"?parseInt(h.event.groupId):parseInt(h.event.id);var f=bookacti.booking_system[a]["events_data"][g]["activity_id"];var d=$j("#bookacti-booking-filter-activities").val()?$j("#bookacti-booking-filter-activities").val():[];if($j.isNumeric(d)){d=[d]}if(d){if($j.isArray(d)){if(d.length&&$j.inArray(f+"",d)===-1){c.class_names.push("bookacti-event-hidden")}}}});b.on("bookacti_calendar_event_content",function(k,c,j){var f=-1;for(var d=0;d<c.domNodes.length;d++){if(c.domNodes[d].classList.contains("bookacti-availability-container")){f=d;break}}if(f<0){return}var h=parseInt(bookacti.booking_system[a]["events_data"][j.event.groupId]["availability"]);var g=$j(c.domNodes[f]);g.find(".bookacti-available-places").append(' / <span class="bookacti-total-places-number">'+h+"</span>");c.domNodes[f]=g[0]});$j("#bookacti-bookings-calendar-settings").on("click",function(){bookacti_dialog_update_bookings_calendar_settings()});$j("#bookacti-bookings-calendar-settings-dialog").on("change","#bookacti-tooltip_booking_list",function(){if($j(this).is(":checked")){$j("#bookacti-event-booking-list-columns-container").show()}else{$j("#bookacti-event-booking-list-columns-container").hide()}});$j("#bookacti-booking-list-filters-form").on("submit",function(c){if($j("#bookacti-submit-filter-button").data("ajax")){c.preventDefault();bookacti_filter_booking_list()}});bookacti_refresh_booking_group_frame();$j("#bookacti-booking-list").on("bookacti_booking_list_filtered bookacti_grouped_bookings_displayed",function(){bookacti_init_tooltip();bookacti_refresh_booking_group_frame()});$j("body").on("bookacti_booking_deleted",function(){bookacti_refresh_booking_group_frame()});$j("body").on("bookacti_booking_rescheduled",function(){bookacti_init_tooltip();var c=$j("#bookacti-booking-system-bookings-page");bookacti_booking_method_refetch_events(c);bookacti_refresh_booking_numbers(c)});$j("body").on("bookacti_booking_state_changed bookacti_payment_status_changed",function(k,c,h,g,f,j,i){bookacti_init_tooltip();if(!i){return false}var d=$j("#bookacti-booking-system-bookings-page");bookacti_refresh_booking_numbers(d)});$j("body").on("bookacti_booking_refunded bookacti_booking_quantity_changed",function(){bookacti_init_tooltip();var c=$j("#bookacti-booking-system-bookings-page");bookacti_refresh_booking_numbers(c)});$j("body").on("submit",".bookacti-list-table-go-to-page-form",function(d){if(!$j("#bookacti-submit-filter-button").data("ajax")){return}d.preventDefault();var c=$j(this).find(".current-page").val();bookacti_filter_booking_list(c)});$j("#bookacti-bookings-container").on("click",".first-page, .prev-page, .next-page, .last-page",function(g){if(!$j("#bookacti-submit-filter-button").data("ajax")){return}g.preventDefault();var c=$j(this).attr("href");var f=c.indexOf("paged=");var d=f!==-1?c.substr(f+6):1;bookacti_filter_booking_list(d)})});